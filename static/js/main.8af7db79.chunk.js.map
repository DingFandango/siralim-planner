{"version":3,"sources":["markdown/ChangeLog.md","components/ChangeLog.js","markdown/InfoSection.md","components/InfoSection.js","components/InfoModal.js","components/UploadPartyModal.js","components/AppHeader.js","components/AppFooter.js","icons/attack.png","icons/health.png","icons/intelligence.png","icons/defense.png","icons/speed.png","components/MonsterClassIcon.js","icons/nature.png","icons/chaos.png","icons/sorcery.png","icons/death.png","icons/life.png","components/MonsterSelectionModal.js","components/MonsterPlanner.js","components/SpecializationPlanner.js","functions/parsePartyString.js","SiralimPlanner.js","App.js","reportWebVitals.js","index.js"],"names":["ChangeLog","state","markdown","fetch","md","then","res","text","setState","this","PureComponent","InfoSection","InfoModal","className","overlayClassName","isOpen","props","modalIsOpen","id","onClick","closeModal","icon","faTimes","UploadPartyModal","partyString","error","uploadPartyFromString","err","message","bind","e","target","value","autoFocus","placeholder","onChange","handleInputChange","handleUploadPartyString","faUpload","Component","AppHeader","href","rel","compendiumVersion","openUploadBuildModal","openInfoModal","faInfoCircle","AppFooter","MonsterClassIcon","str","pi","toLowerCase","title","replace","txt","charAt","toUpperCase","substr","src","alt","metadata","require","HeaderField","stat","icon_health","icon_attack","icon_intelligence","icon_defense","icon_speed","faCaretUp","sortOrder","type","faSortNumericDownAlt","faSortAlphaDownAlt","faSortNumericDown","faSortAlphaDown","class_name","sortable","updateSortField","sort_name","startsWith","renderStatIcon","field_name","renderSortButton","MonsterSelectionRowHeader","sortField","not_sortable","map","field","i","MonsterStat","avgStat","average_stats","minStat","min_stats","maxStat","max_stats","colour","positive","opacity","style","getStatBackground","MonsterStats","Fragment","MonsterSelectionRow","cls","fullName","c","class","iconedClass","inParty","faCheck","renderClass","renderFullRow","family","creature","trait_name","trait_description","stats","material_name","getPageFamily","m","MonsterSelectionModal","filteredItems","filteredItemGroups","currentPage","currentSearchTerm","appliedSearchTerm","searchTimeout","tableRef","React","createRef","filterResults","items","itemGroups","currentGroup","monstersInCurrentGroup","length","f","familyStart","push","Math","max","end","familyEnd","window","clearTimeout","setTimeout","applySearchTerm","order","sort","a","b","sf","split","af","_","get","bf","compare","searchTerm","item","search_text","indexOf","sortedFilteredItems","sortResults","getItemGroups","current","scrollTo","r","pageNum","itemGroup","pageStart","pageEnd","start","String","slice","startIndex","endIndex","slot","currentTraitSlotId","slot_n","currentMonster","isEmpty","currentSelectedMonster","currentPartyMemberId","handleSearchChange","role","goToPage","renderPageName","ref","monsterRow","uid","onMouseUp","updatePartyMember","monstersInParty","has","renderResultsCount","MonsterPlannerRow","monster","MonsterPlannerCreatureSprite","sprite_filename","MonsterPlannerTraitSlot","justUpdated","justUpdatedTimeout","prevProps","prevState","isEqual","setJustUpdated","clearJustUpdated","traitSlotIndex","faExclamationTriangle","rowErrors","getRowErrors","emptyRow","isEmptyRow","rowClass","draggable","onDragStart","onDragOver","onDrop","renderEmptyRow","clearPartyMember","MonsterPlannerCreatureClass","monsterClass","MonsterPlannerCreatureStats","health","attack","intelligence","defense","speed","m1","monster_1","m2","monster_2","floor","MonsterPlannerPartyMember","getMonsterClass","pm1","partyMember","pm2","traitSlot","partyMemberId","traitSlotId","MonsterPlanner","handleDragStart","data","event","fromItem","JSON","stringify","dataTransfer","setData","dragging","handleDragOver","preventDefault","handleDrop","parse","getData","toItem","swapItems","partyMembers","fromPID","fromTID","toPID","toTID","fromObj","toObj","updatePartyMembers","myRef","openModal","handleMouseUp","specializationsList","Option","components","ValueContainer","IconOption","label","MyValueContainer","children","hasValue","getValue","customStyles","control","provided","border","isSelected","isFocused","color","boxShadow","SpecializationPlannerAnointmentsModal","currentSpecialization","specializations","specialization","s","abbreviation","anointmentNames","Set","anointmentsInSpecialization","anointments","hasOwnProperty","spec_abbrev","add","name","maxAnointments","handleSpecializationChange","atMaxAnointments","perks","perk","toggleAnointment","anointment","undefined","description","par","SpecializationPlannerAnointment","spec","SpecializationPlanner","anointmentsModalIsOpen","document","body","selectedOption","updateSpecialization","freeAnointmentSlots","Array","fill","specOptions","toggleOpen","faChevronLeft","faChevronRight","closeAnointmentsModal","styles","options","menuPosition","openAnointmentsModal","faBolt","parsePartyString","Error","sections","anointment_names","line","size","parseCharacterSection","traitsArray","innates","secondaries","artifacts","innateDetectionText","fusedDetectionText","traitSlotDetectionText","creatures","innateTrait","secondaryTrait","artifactTrait","lines","atLeastOne","innate","fusion","artifact","parseCreatureSection","traits","Modal","setAppElement","monsterData","compendium_version","monsterUIDMap","monsterMap","parseInt","buildUIDMap","monsterTraitMap","traitMap","buildTraitMap","anointmentUIDMap","anointmentNameMap","p","buildAnointmentMaps","specializationNameMap","buildSpecializationNameMap","NotificationBanner","hidden","fadeOutTimeout","status","notificationIndex","setHidden","SiralimPlanner","currentSlotId","infoModalIsOpen","uploadBuildModalIsOpen","notificationText","notificationStatus","saveString","pm","history","getMonstersInParty","generateSaveString","newMembers","newAnointments","uids","currentUid","a_uids","match","seen_uids","noti","j","min","windowUrl","location","search","params","URLSearchParams","loadString","parseLoadString","populateFromUids","console","log","specString","parseSpecString","anointmentString","parseAnointmentsString","getElementById","focus","t","t_","callback","traitsToUids","deleted","splice","limit","closeUploadBuildModal","closeInfoModal","updateAnointments","withRouter","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.8af7db79.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/ChangeLog.ae23057f.md\";","import React, {PureComponent} from 'react';\n\nimport ReactMarkdown from 'react-markdown';\n\nimport md from '../markdown/ChangeLog.md';\n\nclass ChangeLog extends PureComponent {\n\n  constructor() {\n    super();\n    this.state = { markdown: '' };\n  }\n\n  componentWillMount() {\n    fetch(md).then(res => res.text()).then(text => this.setState({ markdown: text }));\n  }\n\n  render() {\n    return (\n      <section>\n        <ReactMarkdown>{this.state.markdown}</ReactMarkdown>\n      </section>\n    )\n  }\n}\n\nexport default ChangeLog;","export default __webpack_public_path__ + \"static/media/InfoSection.52ede4e1.md\";","import React, {PureComponent} from 'react';\nimport ReactMarkdown from 'react-markdown';\n\nimport md from '../markdown/InfoSection.md';\n\n/**\n * The InfoSection which resides in the InfoModal.\n * Renders markdown from markdown/InfoSection.md.\n */\nclass InfoSection extends PureComponent {\n\n  constructor() {\n    super();\n    this.state = { markdown: '' };\n  }\n\n  /**\n   * When component is mounted, retrieve the markdown.\n   * @return {void}\n   */\n  componentWillMount() {\n    fetch(md).then(res => res.text()).then(text => this.setState({ markdown: text }));\n  }\n\n  /**\n   * Render function.\n   * @return {ReactComponent} A <section> element containing the markdown.\n   */\n  render() {\n    return (\n      <section>\n        <ReactMarkdown>{this.state.markdown}</ReactMarkdown>\n      </section>\n      )\n    }\n}\n\nexport default InfoSection;","import React, {PureComponent} from 'react';\nimport ChangeLog from './ChangeLog'\nimport InfoSection from './InfoSection'\nimport Modal from 'react-modal';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faTimes } from '@fortawesome/free-solid-svg-icons'\n\nclass InfoModal extends PureComponent {\n  render() {\n    return (\n        <Modal className=\"modal-content modal-content-info\" overlayClassName=\"modal-overlay modal-overlay-info is-open\" isOpen={this.props.modalIsOpen}>\n          <div className=\"modal-header\">\n            <button id=\"close-info-modal\" className=\"modal-close\" aria-label=\"Close info\" onClick={this.props.closeModal}><FontAwesomeIcon icon={faTimes} /></button>\n          </div>\n          <div className=\"info-modal\">\n            <InfoSection/>\n            <hr/>\n            <ChangeLog/>\n          </div>\n        </Modal> \n    )\n  }\n}\n\nexport default InfoModal;","import React, {Component} from 'react';\nimport Modal from 'react-modal';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faTimes, faUpload } from '@fortawesome/free-solid-svg-icons'\n\n\n/**\n * The upload party model, which pops up when clicking the Upload Party\n * button at the top.\n * @property {String} partyString The string that the user has entered into the box.\n * @property {String} error The current error message, if any.\n */\nclass UploadPartyModal extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      partyString: \"\",\n      error: null,\n    }\n  }\n\n  /**\n   * Handle the \"upload\" of a party string.\n   * Do this by calling the function from props and checking for errors.\n   */\n  handleUploadPartyString() {\n    this.props.uploadPartyFromString(this.state.partyString, function(err) {\n      if(err) {\n        this.setState({\n          error: err.message,\n        });\n      } else {\n        this.setState( {\n          partyString: \"\",\n          error: null,\n        });\n      }\n    }.bind(this));\n  }\n\n  /**\n   * Handle the input change for the textarea.\n   * @param  {Event} e The event that sparked this function.\n   */\n  handleInputChange(e) {\n    this.setState({\n      error: null,\n      partyString: e.target.value,\n    });\n  }\n\n  /**\n   * The render function.\n   * @return {ReactComponent} The modal.\n   */\n  render() {\n    return (\n\n      <Modal className=\"modal-content modal-content-info modal-sm\" overlayClassName=\"modal-overlay modal-overlay-info is-open\" isOpen={this.props.modalIsOpen}>\n        <div className=\"modal-header\">\n          <button id=\"close-upload-party-modal\" className=\"modal-close\" onClick={this.props.closeModal}><FontAwesomeIcon icon={faTimes} /></button>\n        </div>\n        <div className=\"info-modal\">\n          <h2>Upload party</h2>\n          <p>Paste your party string into the box below and click \"upload\" to upload your party. You can get your build string in-game by going to Options and then Export Data to Clipboard.</p>\n          { this.state.error && <div className=\"notification notification-error\"><b>Error: </b>{this.state.error}</div>}\n          <textarea autoFocus id=\"upload-party-textarea\" placeholder=\"Paste party string here\" onChange={(e) => this.handleInputChange(e)} value={this.state.partyString}></textarea>\n          <button id=\"upload-party-button\" className=\"button-lg\" onClick={this.handleUploadPartyString.bind(this)}><FontAwesomeIcon icon={faUpload}/>&nbsp;Upload</button>\n        </div>\n      </Modal>\n    )\n  }\n}\n\nexport default UploadPartyModal;","import React, {PureComponent} from 'react';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faUpload, faInfoCircle } from '@fortawesome/free-solid-svg-icons'\n\nclass AppHeader extends PureComponent {\n  render() {\n    return (\n      <header className=\"app-header\">\n        <div className=\"container\">\n        <div className=\"app-header-left\">\n          <h3>Siralim Planner <span className=\"version-num\">v1.02</span></h3>\n        </div>\n        <div className=\"app-header-right\">\n          <p><a href=\"https://docs.google.com/spreadsheets/d/1qvWwf1fNB5jN8bJ8dFGAVzC7scgDCoBO-hglwjTT4iY/edit#gid=0\" target=\"_blank\" rel=\"noreferrer\">Compendium</a> {this.props.compendiumVersion}</p>\n          <button id=\"upload-build\" className=\"lighter\" onClick={this.props.openUploadBuildModal}><FontAwesomeIcon icon={faUpload}/><span>Upload party</span></button>\n          <button id=\"close-info-modal\" className=\"lighter\" onClick={this.props.openInfoModal}><FontAwesomeIcon icon={faInfoCircle}/><span>Info</span></button>\n        </div>\n        </div>\n      </header>\n    )\n  }\n}\n\nexport default AppHeader;","import React, {PureComponent} from 'react';\n\nclass AppFooter extends PureComponent {\n  render() {\n    return (\n      <footer>\n        <div className=\"container\">\n          <p>2021 Created by BeratedBert. This site is not affiliated with Thylacine Studios.</p>\n          <p>Data sourced from the <a href=\"https://docs.google.com/spreadsheets/d/1qvWwf1fNB5jN8bJ8dFGAVzC7scgDCoBO-hglwjTT4iY/edit#gid=0\" target=\"_blank\" rel=\"noreferrer\">Siralim Ultimate Compendium</a>. Creature sprites and stats sourced from the <a href=\"https://github.com/rovermicrover/siralim-ultimate-api\" target=\"_blank\" rel=\"noreferrer\">Siralim Ultimate API</a>.</p>\n        </div>\n      </footer>\n    )\n  }\n}\n\nexport default AppFooter;","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABrSURBVDhPYxgI8B8Jkwz+b9iw4f/FixfJMgCuuby8nGQDhpBmZEWka57HwvL/Ah8fWDG5zgYbQJGfYa4gS3NXVuT//CAnuCEw70Ck8QO45kBLHZgmsEFQNkGArhkGiNIMAjCNRGugEmBgAAAqHok4g5BTHQAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAACBSURBVDhPrY6LDcAgCAVdQLdzwU7UjWgBUfxgNfYS0hTevdb9Dahpmd0IuEOA90pPfOc1MbsROQAxtsHZLVOHVNDao8Mq0wdTeLRbLxiNVXB5/12SZMyiw2qBjmaJumOWlZr8F12Jkq2vC33JhixUJbuyQIIe3PFpnSNZOJIXcO4BphoCLAPQr8oAAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABgSURBVDhPY6An+A/FZIH/Fx58+t+26SHJhoA1kK0ZpJEizSCN1NKMDWMFKJpB2L30LAYGqYMoRwVwPyNjdMNA6iDKUQFMAgMToxkXoFwzIT/jAui2UqSZLECRZhIBAwMAzw+wpM3b+H8AAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABnSURBVDhPY6AW+E8mhoP/Vc2T/p+49JQoDFIL0gPRCgFgweDYXKIwXgNAND5MlAFT52/AikkyAN3fhAwAAZyGEKMZBAbeABDAMIQUzSBAsQEggKKBVM0wANdIjmYYgGkiSzORgIEBANz0XZxQ5MfNAAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAACVSURBVDhPrZDLEYAwCERztFNr82whluHdBqJLIAFJjL+d2QOwvHzCX4odXyrGZSxeZ+ujh0yKtkWhbRrqoBsQCViQgvCsKnMqajGBBNK5RfNU3UNN6YbsH4gVEDVyKe4lw2zzBDbPnNyJ6OW+AqiZk32CCueaZ+jRRkU0dH8hywztQSAJFKAsP4BoGeAbwFmflpVC2AGO+1AuRQifMwAAAABJRU5ErkJggg==\"","import icon_nature  from '../icons/nature.png'\nimport icon_chaos   from '../icons/chaos.png'\nimport icon_sorcery from '../icons/sorcery.png'\nimport icon_death   from '../icons/death.png'\nimport icon_life    from '../icons/life.png'\n\n/**\n * Simple function to convert to Title Case.\n * Found here: https://stackoverflow.com/questions/196972/convert-string-to-title-case-with-javascript\n * @param  {String} str The string to convert to title case.\n * @return {String}     The string that has been convered to title case.\n */\nfunction toTitleCase(str) {\n  return str.replace(\n    /\\w\\S*/g,\n    function(txt) {\n      return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\n    }\n  );\n}\n\n// A simple function to render a monster class icon.\n// It knows which icon to render via props.icon.\nfunction MonsterClassIcon(props) {\n  let pi = props.icon.toLowerCase();\n  let icon;\n  if(pi === \"nature\") icon = icon_nature;\n  if(pi === \"chaos\")  icon = icon_chaos;\n  if(pi === \"sorcery\") icon = icon_sorcery;\n  if(pi === \"death\") icon = icon_death;\n  if(pi === \"life\") icon = icon_life;\n\n  return (\n    <span className=\"cls-icon\">{icon && <img title={toTitleCase(pi)} src={icon} className=\"class-icon\" alt={\"class-\" + pi}/>}</span>\n  )\n}\n\nexport default MonsterClassIcon;","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAHYcAAB2HAY/l8WUAAADaSURBVDhPnY+vEkFhEMVvUjRF0yTB7ZI3MBIvYEYgaaKiyeINou4NNK+0/Hbt53Ov67ucmTOzc/ac/ZMlIE/+BVkWfSW1Sc0hs0NX1qeBkhrNWmloYLLryOY8VFI3HSLjVVtJcH8dKaldx2PWKnSLb/chHvYr6i4JGxZFT83lFyA995GxqCFMp+nB+AVIr+6K0GCTb4mDkF7tAAycmHrB3yBjUYPk01bY5MFPL0C8ZCz6wtsQag+WdbwWqUINbtpecmVZx/gNbgovxNqDjSHH21xJbdLvSISz7A7eQgMqQbAHmgAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAHYcAAB2HAY/l8WUAAABvSURBVDhPnY6BCcAwCARDBsjqXa0bpXmoYNXXpAdCRO9NK5hv/WLeY8yrdwnRVeJk9EFgiFtmPd4QNHRZ9+oXjlLOAkJhVwapsCUzwc4gWFKhkgEVbBiWLXaBhq0KoXLQU2R4fN3yuX4qC1oo5NYeV47XQ9j3i0wAAAAASUVORK5CYII=\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAHYcAAB2HAY/l8WUAAACISURBVDhPtY/RDYAgDETZjolcAfdhDxNG0D+/WaDSKoQiFsH4kouk12ur+hu4NATMeiHh+yz1MTwgBsCajZTXgkTSVgzuzpPw/faazwOQ2ERBVF4LahKbalubA0BPKVAOyL0qZBp7Ozmp8Bg0HRvc6umbXyJ4DCo+bJE8hvSfkseQGprhTpQ6AD/SwQsx8BX/AAAAAElFTkSuQmCC\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAHYcAAB2HAY/l8WUAAACtSURBVDhPjVHBDcQgDGMpvt3hlqh0C7FUh+KUC64TX07FklUabCdAq9FnzS30eZ5jjnElWm0jhN1iCM1giT6P452EZlQzNT+QgNe8J7A16o8BRu2Mf+wXAfnMFJFWwz7Db7gAnb5jrxrCYDSyQYJPgaAYqLXCbPAuGqRGaJZJ4eeFyL5xjf0lVvAiKYoGD8EkXkvgRcaucY3j/Akw5NdQPpgBPp9ywwyYsKKitQ8BaTkO0EhcpwAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAHYcAAB2HAY/l8WUAAACXSURBVDhPnU/bDcNACLvPbNrZ8p1BOkb/swCNUYwcyj1USxYnsM3RFmB3/QtmnwMByyEq7Jm7Ydlg9n7ZuW/P3uRHbkKtKLMhXITNSvYhqMBBmLFNmUKod8RdFEXA1XdKAPt4XwyEEO9RQARVIWQECGm8CbD+IEKU7EMwgm9DrSizEvku35xM5e2KPKgMXXPGdNsKJubWvk+t9fHt6TV2AAAAAElFTkSuQmCC\"","import React, {Component, PureComponent} from 'react';\nimport _ from 'underscore';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\n\nimport icon_attack  from '../icons/attack.png'\nimport icon_health  from '../icons/health.png'\nimport icon_intelligence from '../icons/intelligence.png'\nimport icon_defense   from '../icons/defense.png'\nimport icon_speed    from '../icons/speed.png'\n\nimport { faCheck } from '@fortawesome/free-solid-svg-icons'\nimport { faTimes } from '@fortawesome/free-solid-svg-icons'\nimport { faCaretUp } from '@fortawesome/free-solid-svg-icons'\nimport { faSortAlphaDown } from '@fortawesome/free-solid-svg-icons'\nimport { faSortAlphaDownAlt } from '@fortawesome/free-solid-svg-icons'\nimport { faSortNumericDown } from '@fortawesome/free-solid-svg-icons'\nimport { faSortNumericDownAlt } from '@fortawesome/free-solid-svg-icons'\n\nimport MonsterClassIcon from './MonsterClassIcon'\n\nconst metadata = require('../data/metadata');\n\nconst MONSTERS_PER_PAGE = 120;\n\n// A single field in the header of the Monster Selection table.\nclass HeaderField extends PureComponent {\n\n  // For stats, render a stat icon according to their value.\n  renderStatIcon(stat) {\n    let icon = \"\";\n\n    if(stat === \"stats.health\") icon = icon_health;\n    if(stat === \"stats.attack\")  icon = icon_attack;\n    if(stat === \"stats.intelligence\") icon = icon_intelligence;\n    if(stat === \"stats.defense\") icon = icon_defense;\n    if(stat === \"stats.speed\") icon = icon_speed;\n    \n    return (<img src={icon} className=\"class-icon\" alt={\"stat-\" + stat}/>);\n  }\n\n  // Render a sort button when sortOrder is not null.\n  renderSortButton() {\n    let icon = faCaretUp;\n    switch(this.props.sortOrder) {\n      case 'asc':\n        icon = this.props.type === \"numeric\" ? faSortNumericDownAlt : faSortAlphaDownAlt;\n        break;        \n      case 'desc':\n        icon = this.props.type === \"numeric\" ? faSortNumericDown : faSortAlphaDown;\n        break;\n      default:\n        return \"\";\n    }\n    return <FontAwesomeIcon icon={icon}/>;\n  }\n\n  render() {\n    return (\n      <div className={(\"monster-row-\" + this.props.class_name) + (this.props.sortable ? \" sortable\" : \"\")}\n       onClick={() => { if(this.props.sortable) this.props.updateSortField(this.props.sort_name)} }\n      >\n        {this.props.sort_name.startsWith('stats') ? this.renderStatIcon(this.props.sort_name) : this.props.field_name}\n        {\n          this.props.sortable &&\n          <span className=\"sort-button\">\n            { this.renderSortButton() }\n          </span>\n        }\n      </div>\n    )\n  }\n}\n\n// The header of the monster table (on the monster selection window).\nclass MonsterSelectionRowHeader extends PureComponent {\n\n  render() {\n\n    const fields = [\n      {sort_name: \"\", class_name: \"in-party\", field_name: \"\", not_sortable: true},\n      {sort_name: \"class\", type: \"alpha\", class_name: \"class\", field_name: \"Class\"},\n      {sort_name: \"family\", type: \"alpha\",class_name: \"family\", field_name: \"Family\"},\n      {sort_name: \"creature\", type: \"alpha\", class_name: \"creature\", field_name: \"Creature\"},\n      {sort_name: \"trait_name\", type: \"alpha\", class_name: \"trait_name\", field_name: \"Trait\"},\n      {sort_name: \"trait_description\", type: \"alpha\", class_name: \"trait_description\", field_name: \"Trait Description\"},\n      {sort_name: \"stats.health\", type: \"numeric\", class_name: \"stat\", field_name: \"H\"},\n      {sort_name: \"stats.attack\", type: \"numeric\", class_name: \"stat\", field_name: \"A\"},\n      {sort_name: \"stats.intelligence\", type: \"numeric\", class_name: \"stat\", field_name: \"I\"},\n      {sort_name: \"stats.defense\", type: \"numeric\", class_name: \"stat\", field_name: \"D\"},\n      {sort_name: \"stats.speed\", type: \"numeric\", class_name: \"stat\", field_name: \"S\"},\n      {sort_name: \"material_name\", type: \"alpha\", class_name: \"material_name\", field_name: \"Material Name\"}\n    ]\n\n    return (\n      <div className={\"monster-selection-row monster-row-header detailed\" + (this.props.sortField ? \" sorted\" : \"\")}>\n        { fields.map((field, i) => \n          <HeaderField key={i}\n                       sort_name={field.sort_name}\n                       class_name={field.class_name}\n                       field_name={field.field_name}\n                       sortable={!field.not_sortable}\n                       type={field.type}\n                       sortOrder={field.sort_name === this.props.sortField ? this.props.sortOrder : null}\n                       updateSortField={this.props.updateSortField}\n                       />\n        )}      \n            \n      </div>\n    )\n  }\n}\n\n\n\n// A single stat in the MonsterSelection table, colourised based on how high it is with\n// respect to the stats of other monsters.\nclass MonsterStat extends PureComponent {\n\n  // Colour the background according to the stat's value with respect to the stats of\n  // the other monsters.\n  // This is determined via the metadata.\n  getStatBackground() {\n    const stat = this.props.stat;\n    const value = this.props.value;\n\n    const avgStat = metadata.average_stats[stat.toLowerCase()];\n    const minStat = metadata.min_stats[stat.toLowerCase()];\n    const maxStat = metadata.max_stats[stat.toLowerCase()];\n\n    let colour = 'rgba(0, 0, 0, ';\n    let positive = 0;\n    if(value > avgStat) positive = 1;\n    else if (value < avgStat) positive = -1;\n\n    let opacity = 0;\n    if(positive > 0) opacity = (value - avgStat) / (maxStat - avgStat);\n    else if(positive < 0) opacity = (avgStat - value) / (avgStat - minStat);\n\n    if(positive > 0) colour = 'rgba(0, 235, 16, ';\n    else if(positive < 0) colour = 'rgba(252, 19, 3, ';\n    return {'background': colour + (opacity * 0.75) + ')'}\n  }\n\n  render() {\n\n    return (\n      <div className={\"monster-row-stat \"}>\n        <span className=\"mobile-only ib\"><b>{this.props.stat}:&nbsp;</b></span>\n        <span className=\"stat-value\" style={this.getStatBackground()}>{this.props.value || \"-\"}</span>        \n      </div>\n    )\n  }\n}\n\n\n// A fragment of all stats of a particular monster in the MonsterSelection table.\nclass MonsterStats extends PureComponent {\n\n  render() {\n    const stats = ['Health', 'Attack', 'Intelligence', 'Defense', 'Speed'];\n    return (\n      <React.Fragment>\n        {stats.map((stat, i) => \n          <MonsterStat key={i} stat={stat} value={this.props[stat.toLowerCase()]} />\n        )}\n      </React.Fragment>\n    )\n  }\n}\n\nclass MonsterSelectionRow extends Component {\n\n  // A function for rendering a particular class (cls). \n  // It will render an icon if the class is one of the 5 classes in the game,\n  // otherwise it will render the full name of the class (e.g. \"Rodian Master\").\n  renderClass(cls, fullName) {\n    let c = this.props.class.toLowerCase();\n    let iconedClass = c === \"nature\" || c === \"chaos\" || c === \"death\" || c === \"sorcery\" || c === \"life\";\n\n    return (\n      <div className={\"cls-container\" + (!fullName ? \" center\" : \"\")}>\n        { iconedClass && <MonsterClassIcon icon={this.props.class} /> }\n        <span className={\"cls-full-name col-cls-\" + cls.toLowerCase()}>{this.props.class}</span>\n      </div>\n    )\n  }\n\n  render() {\n    return (\n      <div className={\"monster-selection-row\" + (this.props.inParty ? \" in-party\" : \"\")}>\n        <div className=\"monster-row-in-party\">\n          { this.props.inParty && <span className=\"green-tick\"><FontAwesomeIcon icon={faCheck}/></span>}\n        </div>\n\n        <div className=\"monster-row-class\">\n          <span className=\"mobile-only ib\"><b>Class:&nbsp;&nbsp;</b></span>{this.renderClass(this.props.class, this.props.renderFullRow)}\n        </div>\n        <div className=\"monster-row-family\">\n          <span className=\"mobile-only ib\"><b>Family:&nbsp;</b></span>{this.props.family}\n        </div>\n        <div className=\"monster-row-creature\">\n          <span className=\"mobile-only ib\"><b>Creature:&nbsp;</b></span>{this.props.creature}\n        </div>\n        <div className=\"monster-row-trait_name\">\n          <span className=\"mobile-only ib\"><b>Trait name:&nbsp;</b></span>{this.props.trait_name}\n        </div>\n        <div className={\"monster-row-trait_description\"}>\n          <span className=\"mobile-only ib\"><b>Trait description:&nbsp;</b></span>{this.props.trait_description}        \n        </div>\n\n        <MonsterStats {...this.props.stats}/>\n\n        <div className=\"monster-row-material_name\">\n          {this.props.material_name}\n        </div>\n      </div>\n    );\n  }\n}\n\n\n\n\n\n\n\n/**\n * A simple function that returns the family of a creature, or the class + ' traits' in the case that\n * the family is not present (as is the case for backer traits).\n * This is used for the page names on the Monster Selection window.\n * @param  {Object} m A monster object, which has a name, family, class etc.\n * @return {String}   The semantic name of the family for the page tab.\n */\nfunction getPageFamily(m) {\n  return m.family ? m.family : m.class + \" traits\"; // Exception for Backer traits\n}\n\n/**\n * Get the 'semantic name' of a monster, for the top of the Monster Selection window.\n * i.e. \"Abomination / Brute\".\n * @param  {Object} m A monster object, which has a name, family, class etc. \n * @return {String}   A string representing the semantic name of the monster.\n */\nfunction getMonsterSemanticName(m) {\n  return m.family ? (m.family + \" / \" + m.creature) : (m.class + \" (\" + m.trait_name + \")\");\n}\n\n\n/**\n * The Monster Selection modal, i.e. the window that contains a list of all monsters/traits in\n * Siralim Ultimate.\n * @property {Array} state.filteredItems An array of items from props.items that have been filtered\n *                                       according to the current search term.\n * @property {Array} state.filteredItemGroups An array of item group objects, representing the start and\n *                                      end index of each page.\n * @property {Integer} state.currentPage The index of the current page that the user is on.\n * @property {String} state.currentSearchTerm The current search term, i.e. what is in the search box.\n * @property {String} state.appliedSearchTerm The *applied* search term, which is applied 0.5s after the user finishes\n *                                      typing something into the search box.\n * @property {String} state.sortField The current field to sort by, e.g. \"Class\".                                \n * @property {String} state.sortOrder The current sort order, i.e. null, 'asc', 'desc'.   \n * @property {Timeout} searchTimeout A timeout that takes place after the user stops typing in the search box.\n * @property {Ref}  tableRef  A reference of the monster table, so that it can be used to scroll back\n *                            to the top when switching between pages.\n */\nclass MonsterSelectionModal extends PureComponent {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      filteredItems: [], \n      filteredItemGroups: [{\"start\": 0, \"end\": 0}],\n      currentPage: 0,\n      currentSearchTerm: \"\",\n      appliedSearchTerm: \"\",\n      sortField: null,\n      sortOrder: null,\n    }\n    this.searchTimeout = null;\n    this.tableRef = React.createRef();\n  }\n\n\n\n  /**\n   * When the component is mounted, filter the results and set this.state accordingly.\n   */\n  componentDidMount() {\n    this.filterResults(); // Build this.state.filteredItems\n  }\n\n\n  /**\n   * A terribly written function that basically puts all of the monsters into particular groups.\n   * This is for pagination.\n   * The result is a list of monster groups, for example:\n   * {start: 0, end: 120, familyStart: \"Abomination\", familyEnd: \"Basilisk\"} means that\n   * monster #0 to monster #120 belong on the first page. The first family is Abomination,\n   * and the last family is Basilisk.\n   *\n   * Rather than using fixed page size (i.e. 100), this function ensures that the families\n   * are not split onto separate pages, i.e. there might be 102 on a page so that\n   * one of the families is not split onto two separate pages.\n   * \n   * This function is super awkward and needs rewriting, but it works for now.\n   * @param  {Array} items The list of items (i.e. the list of all monsters/traits).\n   * @return {Array}       An array of Objects, where each represents the start, end, familyStart and familyEnd,\n   *                       for example {0, 50, \"Amaranth\", \"Amphisbeana\"}\n   */\n  getItemGroups(items) {  \n    let itemGroups = [];\n    let currentGroup = {\"start\": 0, \"end\": null, \"familyStart\": null, \"familyEnd\": null}\n    let monstersInCurrentGroup = [];\n    for(let i = 0; i < items.length; i++) {\n      let m = items[i];\n      //let m = item.monster;\n      let f = getPageFamily(m)\n\n      if(!currentGroup.familyStart) currentGroup.familyStart = f;\n      monstersInCurrentGroup.push(m);\n      if((monstersInCurrentGroup.length > MONSTERS_PER_PAGE) && \n          (f !== getPageFamily(monstersInCurrentGroup[Math.max(0, monstersInCurrentGroup.length - 2)]))) {\n        currentGroup.end = i;\n        currentGroup.familyEnd = getPageFamily(monstersInCurrentGroup[Math.max(0, monstersInCurrentGroup.length - 2)]);\n        itemGroups.push(currentGroup);\n        currentGroup = {\"start\": i, \"end\": null, \"familyStart\": f, \"familyEnd\": null}\n        monstersInCurrentGroup = [];\n      }\n    }\n\n    // Catch the last group as well.\n    if(monstersInCurrentGroup.length > 0) {\n      let i = items.length - 1;\n\n      currentGroup.end = i + 1;\n      currentGroup.familyEnd = getPageFamily(monstersInCurrentGroup[Math.max(0, monstersInCurrentGroup.length - 1)]);\n\n      itemGroups.push(currentGroup);\n    }\n\n    return itemGroups;\n  }\n\n  /**\n   * A function that sets the currentSearchTerm to the value the user has typed in the search box.\n   * 0.5s after the user has stopped typing, apply the search term.\n   * @param  {Event} e The event that sparked the search change.\n   */\n  handleSearchChange(e) {\n    window.clearTimeout(this.searchTimeout);\n    this.setState({\n      currentSearchTerm: e.target.value,\n    }, () => {\n      this.searchTimeout = window.setTimeout( () => this.applySearchTerm(), 500);\n    });\n  }\n\n\n  /**\n   * Sort the results of filteredItems based on the current sort field and sort order.\n   * @param  {Array} filteredItems A list of items that have been filtered.\n   * @return {Array}               The sorted filtered items.\n   */\n  sortResults(filteredItems) {\n    const field = this.state.sortField;\n    const order = this.state.sortOrder;\n\n    function compare(a, b) {\n      const sf = field.split('.')\n      let af = _.get(a, sf, -1);\n      let bf = _.get(b, sf, -1);\n      if(af === '') af = \"zzzzzzz\"; // For empty strings (backer traits etc), treat them as if they were zzzz, e.g. last\n      if(bf === '') bf = \"zzzzzzz\";\n\n      if( af < bf ) return order === \"asc\" ? 1 : -1;\n      if( af > bf ) return order === \"asc\" ? -1 : 1;\n      return 0;\n    }\n\n    // Sort the filteredItems if sortField is not null\n    if(this.state.sortField) return filteredItems.sort((a, b) => compare(a, b));\n    return filteredItems;\n  }\n  \n\n  /**\n   * Filter items by applying the current search term to this.props.items.\n   * Afterwards, set this.state accordingly and scroll to the top of the table.\n   */\n  filterResults() {\n    let searchTerm = this.state.currentSearchTerm.toLowerCase();\n    let filteredItems = [];\n    const items = this.props.items;\n    for(let item of items) {\n      let searchText = item.search_text;\n      if(searchText.toLowerCase().indexOf(searchTerm) !== -1) {\n        filteredItems.push(item);\n      }      \n    }\n    const sortedFilteredItems = this.sortResults(filteredItems);\n    const filteredItemGroups = this.getItemGroups(sortedFilteredItems);\n\n    this.setState({\n      currentPage: 0,\n      filteredItems: sortedFilteredItems,\n      filteredItemGroups: filteredItemGroups\n    }, () => { this.tableRef.current.scrollTo(0, 0) }) // Scroll to top of table once complete.\n  }\n\n\n  /**\n   * Apply the search term and filter the results accordingly.\n   */\n  applySearchTerm() {\n    this.setState({\n      appliedSearchTerm: this.state.currentSearchTerm\n    }, () => this.filterResults())\n  }\n\n  /**\n   * A function to render the results count.\n   * The output depends on whether *all* results are being shown,\n   * or a filtered list.\n   * @return {ReactComponent} A span that contains a count of the search results.\n   */\n  renderResultsCount() {   \n\n    let r =  <span><b>{this.state.filteredItems.length}</b> of <b>{this.props.items.length}</b> results</span>;\n    if(this.state.filteredItems.length === this.props.items.length) {\n      r = <span>all <b>{this.props.items.length}</b> results</span>\n    }\n    let f = \"\";\n    if(this.state.appliedSearchTerm) {\n      f = \" matching the current search term\";\n    }\n                \n    return (\n      <span>Displaying {r}{f}.</span>\n    )\n  }\n\n\n  /**\n   * Go to a particular page, i.e. set currentPage = pageNum.\n   * Scroll to top of table once complete.\n   * @param  {Integer} pageNum The index of the page to go to.\n   */\n  goToPage(pageNum) {\n    this.setState({\n      currentPage: pageNum,\n    }, () => { this.tableRef.current.scrollTo(0, 0) })\n  }\n\n\n  updateSortField(sortField) {\n    this.setState({\n      sortField: (sortField === this.state.sortField && this.state.sortOrder === \"asc\") ? null : sortField,\n      sortOrder: \n        this.state.sortField === sortField ? (\n          this.state.sortOrder === \"desc\" ? \"asc\" :\n          (\n            this.state.sortOrder === \"asc\" ? null : \"desc\"\n          )\n        ) : \"desc\"      \n    }, () => this.filterResults())\n  }\n\n\n  /**\n   * Render the name of a page given the index of the page and the itemGroup.\n   * @param  {Integer} i         The page number.\n   * @param  {Object} itemGroup A single itemGroup.\n   * @return {String}           The page name, e.g. \"Amaranth - Amphisbeana\" or \"31 - 36\".\n   */\n  renderPageName(i, itemGroup) {\n    let pageStart = \"\";\n    let pageEnd = \"\";\n\n    let sf = this.state.sortField ? this.state.sortField.split('.') : \"family\";\n    if(!this.state.filteredItems[this.state.filteredItemGroups[i].start]) pageStart = \"(unknown)\";\n    else {\n      pageStart = String(_.get(this.state.filteredItems[this.state.filteredItemGroups[i].start], sf, \"(empty)\"));\n      if(pageStart.length > 8) pageStart = pageStart.slice(0, 7) + \"...\"\n    }\n\n    if(!this.state.filteredItems[this.state.filteredItemGroups[i].end - 1]) pageEnd = \"(unknown)\";\n    else {\n      pageEnd = String(_.get(this.state.filteredItems[this.state.filteredItemGroups[i].end - 1], sf, \"(empty)\"));\n      if(pageEnd.length > 8) pageEnd = pageEnd.slice(0, 7) + \"...\"\n    }\n\n    return pageStart + \" - \" + pageEnd;                        \n  }\n\n  /**\n   * The render function\n   * @return {ReactComponent} The modal content div.\n   */\n  render() {\n\n\n    // Get the start and end index via this.state.filteredItemGroups.\n    let startIndex = this.state.filteredItemGroups[this.state.currentPage] ? this.state.filteredItemGroups[this.state.currentPage].start : 0;\n    let endIndex = this.state.filteredItemGroups[this.state.currentPage] ? this.state.filteredItemGroups[this.state.currentPage].end : 0;\n\n    let slot = (this.props.currentTraitSlotId) === 0 ? \"primary\" : ((this.props.currentTraitSlotId === 2) ? \"secondary\" : \"artifact\");\n    let slot_n = slot === \"artifact\" ? \"n\" : \"\";\n    let currentMonster = !_.isEmpty(this.props.currentSelectedMonster) ? getMonsterSemanticName(this.props.currentSelectedMonster) : null;\n\n\n    return (\n        <div className=\"modal-content\">\n          <div className=\"modal-header\">\n            <h3>Select a{slot_n} <b>{slot}</b> trait for party member <b>{this.props.currentPartyMemberId + 1}</b>. <span style={{'marginLeft': '20px'}}>{currentMonster && (\"Current: \" + currentMonster)}</span></h3>\n            <button id=\"close-modal\" className=\"modal-close\" aria-label=\"Close trait selection\" onClick={this.props.closeModal}><FontAwesomeIcon icon={faTimes} /></button>\n          \n          </div>\n\n          <div className=\"monster-selection-modal\">\n            <div className=\"monster-selection-controls\">\n              <div className=\"monster-selection-search-tools\">\n                <input id=\"monster-search\" className=\"monster-search\" autoFocus type=\"text\" placeholder=\"Search monsters/traits...\" onChange={(e) => this.handleSearchChange(e)} value={this.state.currentSearchTerm} />\n              </div>                \n             <div className=\"monster-selection-pagination\">\n                {this.state.filteredItemGroups.map((itemGroup, i) =>\n                    <div role=\"button\" key={i} onClick={() => this.goToPage(i)} className={\"tab\" + (this.state.currentPage === i ? \" active\" : \"\")}>\n                      {this.renderPageName(i, itemGroup)}\n                    </div>\n                )}\n              </div>\n              <div className=\"mobile-hidden monster-row-container monster-row-container-selection monster-row-container-header\">\n                <MonsterSelectionRowHeader sortField={this.state.sortField} sortOrder={this.state.sortOrder} updateSortField={this.updateSortField.bind(this)} /> \n              </div> \n            </div>\n\n            <div className=\"monster-selection-table monster-list\" ref={this.tableRef}>\n                {this.state.filteredItems.slice(startIndex, endIndex).map((monsterRow, i) =>                 \n                  <div className={\"monster-row-container monster-row-container-selection selectable\" + \n                    ((monsterRow && this.props.currentSelectedMonster && (monsterRow.uid === this.props.currentSelectedMonster.uid)) ? \" currently-selected-monster\" : \"\")}\n                    key={i}\n                    onMouseUp={() => this.props.updatePartyMember(monsterRow)}>\n                    <MonsterSelectionRow {...monsterRow} \n                    renderFullRow={true}\n                    searchTerm={this.state.currentSearchTerm}\n                    inParty={this.props.monstersInParty.has(monsterRow.uid)}\n                    /> \n                  </div>\n                )}              \n            </div>\n            <div className=\"monster-selection-results-count\">\n               { this.renderResultsCount() }\n            </div>\n          </div>\n        </div>\n    )\n  }\n}\n\nexport default MonsterSelectionModal;","import React, {Component, PureComponent} from 'react';\nimport _ from 'underscore';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\n\nimport { faTimes } from '@fortawesome/free-solid-svg-icons'\nimport { faExclamationTriangle } from '@fortawesome/free-solid-svg-icons'\n\nimport icon_attack  from '../icons/attack.png'\nimport icon_health  from '../icons/health.png'\nimport icon_intelligence from '../icons/intelligence.png'\nimport icon_defense   from '../icons/defense.png'\nimport icon_speed    from '../icons/speed.png'\n\nimport MonsterClassIcon from './MonsterClassIcon'\n\n\n/**\n * A class that corresponds to a single MonsterRow from within the Monster Planning window\n * (i.e. the 6 creatures with 3 traits each) of the Monster Selection page.\n */\nclass MonsterPlannerRow extends Component {\n\n  // A function for rendering a particular class (cls). \n  // It will render an icon if the class is one of the 5 classes in the game,\n  // otherwise it will render the full name of the class (e.g. \"Rodian Master\").\n  \n\n  /**\n   * Render a class name along with its icon.\n   * @param  {String} cls      The name of the class.\n   * @return {React.Fragment}          The name of the class plus the icon.\n   */\n  renderClass(cls) {\n    let c = this.props.monster.class.toLowerCase();\n    let iconedClass = c === \"nature\" || c === \"chaos\" || c === \"death\" || c === \"sorcery\" || c === \"life\";\n\n    return (\n      <React.Fragment> \n        { iconedClass && <MonsterClassIcon icon={this.props.monster.class} /> }\n      </React.Fragment>\n    )\n  }\n\n\n  /**\n   * The render function.\n   * @return {React.Fragment} A row representing a trait.\n   */\n  render() {\n    var m = this.props.monster;\n\n    return (\n      <React.Fragment>\n        <div className=\"trait-slot-class\">\n          <span className=\"mobile-only ib\"><b>Class:&nbsp;&nbsp;</b></span>{this.renderClass(m.class)}\n        </div>\n        <div className=\"trait-slot-family\">\n          <span className=\"mobile-only ib\"><b>Family:&nbsp;</b></span>{m.family}\n        </div>\n        <div className=\"trait-slot-creature\">\n          <span className=\"mobile-only ib\"><b>Creature:&nbsp;</b></span>{m.creature}\n        </div>\n        <div className=\"trait-slot-trait_name\">\n          <span className=\"mobile-only ib\"><b>Trait name:&nbsp;</b></span>{m.trait_name}\n        </div>\n        <div className={\"trait-slot-trait_description\"}>\n          <span className=\"mobile-only ib\"><b>Trait description:&nbsp;</b></span>{m.trait_description}\n        </div>\n      </React.Fragment>\n    );\n  }\n}\n\n/**\n * A component that renders the creature sprite.\n */\nclass MonsterPlannerCreatureSprite extends PureComponent {\n\n  /**\n   * The render function\n   * @return {ReactComponent} A creature sprite container with the creature sprite inside.\n   */\n  render() {\n    return (\n      <div className={\"creature-sprite-container\" + (this.props.sprite_filename ? \"\" : \" empty\")}>\n        { this.props.sprite_filename &&\n          <div className=\"creature-sprite\" style={{\"backgroundImage\": \"url(/siralim-planner/suapi-battle-sprites/\" + this.props.sprite_filename + \")\"}}></div>\n        }\n      </div>\n    );\n  }\n}\n\n\n/**\n * A trait slot on the Monster Planner interface.\n * This provides the functionality for dragging and dropping as well as row validation.\n * @property {Boolean} state.justUpdated Whether this component was recently updated (for highlighting).\n * @property {Timeout} justUpdatedTimeout A timeout to keep track of when this component should consider \n *                                        itself no longer just updated.\n */\nclass MonsterPlannerTraitSlot extends PureComponent {\n\n  /**\n   * The constructor\n   * @param  {Object} props The props.\n   */\n  constructor(props) {\n    super(props);\n    this.state = {\n      justUpdated: false, // set to true when the component has just been updated\n                          // (so that the row flashes, providing some nice visual feedback)\n    }\n    this.justUpdatedTimeout = null;\n  }\n\n  // If this component updated, set 'justUpdated' to true so that the row flashes for a second.\n  \n  /**\n   * If this component updated, set 'justUpdated' to true so that the row flashes for a second.\n   * @param  {Object} prevProps The previous props.\n   * @param  {Object} prevState The previous state.\n   */\n  componentDidUpdate(prevProps, prevState) {\n    if(!this.state.justUpdated && !_.isEqual(prevProps.monster, this.props.monster)) this.setJustUpdated();\n  }\n\n  /**\n   * Set just updated to true. When done, create a timeout to set justUpdated to false again after 1s.\n   */\n  setJustUpdated() {\n    this.setState({\n      justUpdated: true\n    }, () => {\n      window.clearTimeout(this.justUpdatedTimeout);\n      this.justUpdatedTimeout = window.setTimeout( () => this.clearJustUpdated(), 1000);\n    })\n  }\n\n  /**\n   * Set state.justUpdated to false.\n   */\n  clearJustUpdated() {\n    this.setState({\n      justUpdated: false,\n    })\n  }\n\n  /**\n   * Return true if this row is empty (i.e. it corresponds to a monster), else false.\n   * @return {Boolean} Whether the row is empty or not.\n   */\n  isEmptyRow() {\n    return _.isEmpty(this.props.monster);\n  }\n\n  \n  /**\n   * Check this row for errors. Return the error in the form of a string if present, else return null.\n   * @return {String} The error message, if any.\n   */\n  getRowErrors() {\n    if(_.isEmpty(this.props.monster)) return null;\n    if(!(this.props.traitSlotIndex === 2) && \n      (this.props.monster.class === \"Rodian Master\" || this.props.monster.class === \"Nether Boss\" || this.props.monster.class === \"Backer\")) \n        return \"This trait cannot be found on a playable creature and cannot be placed in a creature slot.\";\n    if(this.props.traitSlotIndex === 2 && \n      (this.props.monster.material_name === \"N/A\" || this.props.monster.material_name === \"No Material Exists\")) \n        return \"This trait has no material and cannot be placed in the trait slot.\";\n    return null;\n  }\n\n  // A special function for rendering an empty row.\n  // If there was an error (such as the monster no longer existing after uploading), print that error to the row.\n  // Note that this error is different from the output of getRowErrors above - it is a parsing-related error such\n  // as the buildString containing a creature that no longer exists or has changed.\n  \n\n  /**\n   * A special function for rendering an empty row.\n   * If there was an error (such as the monster no longer existing after uploading), print that error to the row.\n   * Note that this error is different from the output of getRowErrors above - it is a parsing-related error such\n   * as the buildString containing a creature that no longer exists or has changed.\n   * @return {ReactComponent} A div representing an empty row.\n   */\n  renderEmptyRow() {\n    return (\n      <div className=\"empty-row\">\n        { this.props.error && <span className=\"trait-slot-error\"><FontAwesomeIcon icon={faExclamationTriangle} />Error: {this.props.error}. </span>}\n        {\"Click to add a\" + (this.props.traitSlotIndex === 0 ? \" primary trait\" : (this.props.traitSlotIndex === 1 ? \" fused trait\" : \"n artifact trait\"))}\n      </div>\n    )\n  }\n\n  /**\n   * The render function.\n   * @return {ReactComponent} A div representing a trait slot.\n   */\n  render() {\n\n    const rowErrors = this.getRowErrors();\n    const emptyRow = this.isEmptyRow();\n\n    let rowClass = \"\";\n    // If this monster has a class, set rowClass accordingly.\n    // This allows the row to be coloured according to the creature's class.\n    if(this.props.monster.class) {\n      rowClass = \" cls-\" + this.props.monster.class.toLowerCase();\n      if(this.props.traitSlotIndex === 2) rowClass = \" cls-trait\";\n    } else {\n      rowClass = \" cls-empty\";\n    }\n\n    return (\n    <div className=\"trait-slot\">\n\n      <div\n        className={\"trait-slot-clickable\" + \n          (this.props.draggable ? \" draggable\": \"\") + \n          (rowErrors ? \" invalid-row\" : \"\") + \n          (this.props.traitSlotIndex === 2 ? \" artifact-slot\" : \"\") +\n          (this.state.justUpdated ? \" just-updated\": \"\") + \n          rowClass\n        }\n        draggable={this.props.draggable}\n        onDragStart={this.props.onDragStart()}\n        onDragOver={this.props.onDragOver()}\n        onDrop={this.props.onDrop()}\n\n        onMouseUp={ this.props.onMouseUp}\n\n        title={rowErrors }\n      >\n      { emptyRow ? this.renderEmptyRow() :\n        <MonsterPlannerRow monster={this.props.monster} error={this.props.error} />   \n      }\n\n      </div>\n      <div className=\"trait-slot-controls\">\n        { !emptyRow && <button id={\"remove-trait-\" + (this.props.traitSlotIndex + 1)} className=\"delete-button\" aria-label=\"Delete trait\" onClick={this.props.clearPartyMember}><FontAwesomeIcon icon={faTimes} /></button>}\n      </div>\n    </div>\n    )\n  }\n}\n\n\n/**\n * A component representing the class of a creature, to be rendered in the monster profile.\n */\nclass MonsterPlannerCreatureClass extends PureComponent {\n\n  /**\n   * The render function.\n   * @return {ReactComponent} A div representing the creature class.\n   */\n  render() {\n    const monsterClass = this.props.monsterClass;\n    return (\n      <div className=\"party-member-class\">\n        { monsterClass !== \"empty\" && <React.Fragment>\n            <MonsterClassIcon icon={monsterClass}/>\n            {monsterClass}\n          </React.Fragment>\n           }\n        { monsterClass === \"empty\" && \"\" }\n      </div>\n    )\n  }\n}\n\n\n/**\n * A component that shows the stats of a creature, to be rendered in the monster profile.\n */\nclass MonsterPlannerCreatureStats extends PureComponent {\n\n  /**\n   * The render function.\n   * @return {ReactComponent} A div containing the monster's stats.\n   */\n  render() {\n    let stats = {\n      health: \"--\",\n      attack: \"--\",\n      intelligence: \"--\",\n      defense: \"--\",\n      speed: \"--\"\n    }\n    const m1 = this.props.monster_1.stats;\n    const m2 = this.props.monster_2.stats;\n\n    if(m1 && !m2) {\n      stats.health = m1.health;\n      stats.attack = m1.attack;\n      stats.intelligence = m1.intelligence;\n      stats.defense = m1.defense;\n      stats.speed = m1.speed;\n    }\n    else if(m1 && m2) {\n      stats.health = Math.floor((m1.health + m2.health) / 2);\n      stats.attack = Math.floor((m1.attack + m2.attack) / 2);\n      stats.intelligence = Math.floor((m1.intelligence + m2.intelligence) / 2);\n      stats.defense = Math.floor((m1.defense + m2.defense) / 2);\n      stats.speed = Math.floor((m1.speed + m2.speed) / 2);\n    }\n\n    return (\n      <div className={\"party-member-stats\" + (stats.health === \"--\" ? \" empty\" : \"\")}>\n        <span><img src={icon_health} className=\"class-icon\" alt={\"stat-health\"} title=\"Health\"/><span>{stats.health}</span></span>\n        <span><img src={icon_attack} className=\"class-icon\" alt={\"stat-attack\"} title=\"Attack\"/><span>{stats.attack}</span></span>\n        <span><img src={icon_intelligence} className=\"class-icon\" alt={\"stat-health\"} title=\"Intelligence\"/><span>{stats.intelligence}</span></span>\n        <span><img src={icon_defense} className=\"class-icon\" alt={\"stat-health\"} title=\"Defense\"/><span>{stats.defense}</span></span>\n        <span><img src={icon_speed} className=\"class-icon\" alt={\"stat-health\"} title=\"Speed\"/><span>{stats.speed}</span></span>\n      </div>\n    )\n  }\n}\n\n/**\n * A component representing a single party member on the Monster Planner interface.\n * @property {String} state.monsterClass The class of the monster.\n */\nclass MonsterPlannerPartyMember extends PureComponent {\n\n  /**\n   * The constructor.\n   * @param  {Object} props The props.\n   */\n  constructor(props) {\n    super(props);\n    this.state = {\n      monsterClass: \"empty\"\n    }\n  }\n\n  /**\n   * When component mounts, get the class of this monster.\n   */\n  componentDidMount() {\n    this.setState({\n      monsterClass: this.getMonsterClass()\n    });\n  }\n\n  /**\n   * When component updates, get the class of this monster.\n   */\n  componentDidUpdate(prevProps, prevState) {\n    if(!_.isEqual(prevProps, this.props)) {\n      this.setState({\n        monsterClass: this.getMonsterClass()\n      });\n    }\n  }\n\n  /**\n   * A function to get the class of this monster, which is based on the first and second monster\n   * of this party member.\n   * @return {String} The class name of this monster, or \"empty\" if it has no class.\n   */\n  getMonsterClass() {\n    const pm1 = this.props.partyMember[0].monster;\n    const pm2 = this.props.partyMember[1].monster;\n    if(pm2 && pm2.class) {\n      return pm2.class;\n    } else if (pm1 && pm1.class) {\n      return pm1.class;\n    }\n    return \"empty\";\n  }\n\n  /**\n   * The render function.\n   * @return {ReactComponent} A div representing this party member.\n   */\n  render() {\n    return (\n      <div className={\"monster-planner-party-member cls-\" + this.state.monsterClass.toLowerCase()}>\n        <div className={\"party-member-profile cls-\" + this.state.monsterClass.toLowerCase()}>\n          <MonsterPlannerCreatureSprite sprite_filename={this.props.partyMember[0].monster ? this.props.partyMember[0].monster.sprite_filename : null}/>\n          <MonsterPlannerCreatureStats monster_1={this.props.partyMember[0].monster} monster_2={this.props.partyMember[1].monster}/>\n          <MonsterPlannerCreatureClass monsterClass={this.state.monsterClass}/>\n\n        </div>\n        <div className={\"party-member-traits cls-\" + this.state.monsterClass.toLowerCase()}>\n\n          {this.props.partyMember.map((traitSlot, i) => \n            <MonsterPlannerTraitSlot\n              monster={traitSlot.monster}\n              error={traitSlot.error}\n              key={i}\n              traitSlotIndex={i}\n              draggable=\"true\"\n\n              onDragStart={() => this.props.onDragStart({ partyMemberId: this.props.partyMemberId, traitSlotId: i })}\n              onDragOver={() => this.props.onDragOver({ partyMemberId: this.props.partyMemberId, traitSlotId: i })}\n              onDrop={() => this.props.onDrop({ partyMemberId: this.props.partyMemberId, traitSlotId: i })}\n              onMouseUp={() => this.props.onMouseUp(this.props.partyMemberId, i, traitSlot.monster ? traitSlot.monster : null)}\n\n              clearPartyMember={() => this.props.clearPartyMember(this.props.partyMemberId, i)}\n            />             \n          )}\n        </div>\n      </div>\n    )\n  }\n}\n\n\n\n\n/**\n * The monster planner interface (i.e. the section with 6 party members).\n * Drag and drop Code found here: https://codepen.io/frcodecamp/pen/OEovqx \n * @property {Boolean} state.dragging Whether the user is currently dragging a trait.\n * @property {Ref} myRef A reference for the element of this div.\n */\nclass MonsterPlanner extends Component {\n\n  /**\n   * The constructor\n   * @param  {Object} props The props.\n   */\n  constructor(props) {\n    super(props);\n    this.state = {\n      dragging: false,\n    }\n    this.myRef = React.createRef();\n  }\n\n  // A function to handle the drag start (i.e. when a row is dragged).\n  \n  /**\n   * A function to handle the drag start (i.e. when a row is dragged).\n   * @param  {Object} data The data from the drag event.\n   */\n  handleDragStart = data => event => {\n    let fromItem = JSON.stringify({ partyMemberId: data.partyMemberId, traitSlotId: data.traitSlotId });\n    event.dataTransfer.setData(\"dragContent\", fromItem);\n    this.setState({\n      dragging: true,\n    })\n  };\n\n  /**\n   * A function to handle the drag over event.\n   * @param  {Object} data The data from the drag event.\n   */\n  handleDragOver = data => event => {\n    event.preventDefault(); // Necessary. Allows us to drop.\n    this.setState({\n      dragging: false,\n    })\n    return false;\n  };\n\n\n  /**\n   * A function to handle the event when dragging something and the mouse button is released.\n   * When this happens, the rows are swapped.\n   * @param  {Object} data The data from the drag event.\n   */\n  handleDrop = data => event => {\n    event.preventDefault();\n\n    let fromItem = JSON.parse(event.dataTransfer.getData(\"dragContent\"));\n    let toItem = { partyMemberId: data.partyMemberId, traitSlotId: data.traitSlotId };\n\n    this.swapItems(fromItem, toItem);\n    return false;\n  };\n\n  // A function to swap two items.\n  // Once this swap is complete, pass this update to the parent component\n  // so that the monsterPlannerRows are updated.\n  // These changes will get propagated back to this component.\n  \n\n  /**\n   * A function to swap two items.\n   * Once this swap is complete, pass this update to the parent component\n   * so that the monsterPlannerRows are updated.\n   * These changes will get propagated back to this component.\n   * @param  {Object} fromItem The swapper.\n   * @param  {Object} toItem   The swapee.\n   */\n  swapItems = (fromItem, toItem) => {\n    let partyMembers = [...this.props.partyMembers];\n\n    let fromPID = fromItem.partyMemberId;\n    let fromTID = fromItem.traitSlotId;\n\n    let toPID = toItem.partyMemberId;\n    let toTID = toItem.traitSlotId;\n\n    let fromObj = {...this.props.partyMembers[fromPID][fromTID]};\n    let toObj   = {...this.props.partyMembers[toPID][toTID]};\n\n    partyMembers[fromPID][fromTID] = toObj;\n    partyMembers[toPID][toTID] = fromObj;\n\n    this.setState({ dragging: false }, () => this.props.updatePartyMembers(partyMembers));\n  };\n\n  // When the mouse button is released while hovering over a row,\n  // call the openModal function on the parent of this component.\n  // i.e. Open the MonsterSelection modal when a row is clicked.\n  \n  /**\n   * When the mouse button is released while hovering over a row,\n   * call the openModal function on the parent of this component.\n   * i.e. Open the MonsterSelection modal when a row is clicked.\n   * @param  {String} partyMemberId The id of the party member that was clicked. (0, 1, 2, 3, 4, 5)\n   * @param  {String} traitSlotId   The id of the trait slot that was clicked (0, 1, 2)\n   * @param  {Object} monster       The monster in the trait slot.\n   */\n  handleMouseUp(partyMemberId, traitSlotId, monster) {\n    this.props.openModal(partyMemberId, traitSlotId, monster);\n  }\n\n  /**\n   * The render function.\n   * @return {ReactComponent} A div containing the Monster Planner interface.\n   */\n  render() {\n    return (\n      <div id=\"monster-planner\" ref={this.myRef}>\n        <h3 className=\"section-title\">Party</h3>\n        {this.props.partyMembers.map((partyMember, i) => \n          <MonsterPlannerPartyMember\n            key={i}\n            partyMember={partyMember}\n            clearPartyMember={this.props.clearPartyMember}\n            partyMemberId={i}\n\n            onDragStart={this.handleDragStart.bind(this)}\n            onDragOver={this.handleDragOver.bind(this)}\n            onDrop={this.handleDrop.bind(this)}\n            onMouseUp={this.handleMouseUp.bind(this)}\n          />\n        )}\n      </div>\n    )\n  }\n}\n\nexport default MonsterPlanner;","import React, {PureComponent} from 'react';\nimport Modal from 'react-modal';\nimport _ from 'underscore';\nimport Select, { components } from 'react-select';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\n\nimport { faChevronLeft } from '@fortawesome/free-solid-svg-icons'\nimport { faChevronRight } from '@fortawesome/free-solid-svg-icons'\nimport { faTimes } from '@fortawesome/free-solid-svg-icons'\nimport { faBolt } from '@fortawesome/free-solid-svg-icons'\nimport { faCheck } from '@fortawesome/free-solid-svg-icons'\n\nconst specializationsList = require('../data/specializations');\n\nconst { Option, ValueContainer } = components;\n/**\n * Override for the Option item in react-select to display icons in the options.\n * @param  {Object} props The props.\n * @return {ReactComponent}       The option.\n */\nconst IconOption = props => (\n  <Option {...props}>\n    <span className=\"option-icon\" style={{\"backgroundImage\": \"url(/siralim-planner/specialization_icons/\" + props.value + \".png)\"}}></span>\n    {props.data.label}\n  </Option>\n);\n\n/**\n * Override for the ValueContainer for react-select to display icons in the select element.\n * @param  {children}    options.children The children from react-select\n * @param  {props} options.props    The props\n * @return {ReactElement}                     The ValueContainer\n */\nconst MyValueContainer = ({children, ...props}) => {\n  const { hasValue } = props;\n  const value = props.getValue()[0];\n  if (!hasValue) {\n    return (\n      <components.ValueContainer {...props}>\n        {children}\n      </components.ValueContainer>\n    );\n  }\n\n  return (\n    <ValueContainer {...props} className=\"value-container\">\n      <span className=\"option-icon\" style={{\"backgroundImage\": \"url(/siralim-planner/specialization_icons/\" + value.value + \".png)\"}}></span>\n      {children}\n    </ValueContainer>\n  )\n};\n\n\n/**\n * Override for customStyles for react-select.\n * @type {Object}\n */\nconst customStyles = {\n  control: (provided, state) => ({\n    ...provided,\n    border: state.isSelected ? '2px solid rgba(0, 0, 0, 0.4) !important' : (state.isFocused ? '2px solid rgba(0, 0, 0, 0.3) !important' : '2px solid rgba(0, 0, 0, 0.4) !important'),\n    color: 'red',\n    boxShadow: \"none\",\n  })\n}\n\n\n\n/**\n * The modal that pops up when the user clicks on the Anointments\n * button on the specializations box on the left side.\n * @property {Object} state.currentSpecialization The current specialization object.\n */\nclass SpecializationPlannerAnointmentsModal extends PureComponent {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      currentSpecialization: null,\n    }\n  }\n\n  /**\n   * When component updates, and the specialisation has changed in the parent\n   * and this component does not yet have a specialization, set the specialization\n   * to the first one in the parent component (i.e. Hell Knight).\n   * @param  {Object} prevProps The previous props.\n   * @param  {Object} prevState The previous state.\n   */\n  componentDidUpdate(prevProps, prevState) {\n    if(!_.isEqual(prevProps.currentSpecialization, this.props.currentSpecialization) && !this.state.currentSpecialization)\n    { \n      this.setState({\n        currentSpecialization: this.props.specializations[0]\n      })\n    }\n  }\n\n\n  /**\n   * Handle the specialization change, i.e. change this.state.currentSpecialization\n   * to the provided specialization.\n   * @param  {obj} specialization The specialization to update to.\n   */\n  handleSpecializationChange(specialization) {\n    let currentSpecialization = null;\n    for(let s of this.props.specializations) {\n      if(s.abbreviation === specialization.abbreviation) {\n        currentSpecialization = s;\n        break;\n      }\n    }\n    this.setState({\n      currentSpecialization: currentSpecialization,\n    })\n  }\n\n  /**\n   * The render function. Is super long and needs breaking down into smaller components.\n   * @return {ReactComponent} The anointments modal.\n   */\n  render() {\n    let anointmentNames = new Set();\n    let anointmentsInSpecialization = {};\n    for(let a of this.props.anointments) {\n      if(!a) continue;\n      if(!anointmentsInSpecialization.hasOwnProperty(a.spec_abbrev)) {\n        anointmentsInSpecialization[a.spec_abbrev] = 0;\n      }\n      anointmentsInSpecialization[a.spec_abbrev]++;\n      anointmentNames.add(a.name);\n    }\n\n    return ( \n      <Modal className=\"modal-content modal-content-info  specialization-selection-modal modal-wide \" overlayClassName=\"modal-overlay modal-overlay-info is-open\" isOpen={this.props.modalIsOpen}>\n        <div className=\"modal-header\">\n          <h3>Anointments <span style={{'marginLeft': '20px'}}> {this.props.anointments.length} of {this.props.maxAnointments} anointments selected</span></h3>\n          <button id=\"close-upload-party-modal\" className=\"modal-close\" onClick={this.props.closeModal}><FontAwesomeIcon icon={faTimes} /></button>\n        </div>\n\n        <div className=\"info-modal specialization-selection\">         \n          <nav className=\"specialization-selection-nav\">\n            {\n              this.props.specializations.map((s, i) => \n                <div key={i} className={\"specialization-option \" + (_.isEqual(this.state.currentSpecialization, s) ? \"current\" : \"\") +\n                  ((anointmentsInSpecialization[s.abbreviation] > 0) ? \" has-anointment\" : \"\")\n\n                  }\n                  onClick={() => this.handleSpecializationChange(s)}>\n                  <span className=\"option-icon\" style={{\"backgroundImage\": \"url(/siralim-planner/specialization_icons/\" + s.abbreviation + \".png)\"}}></span>\n                  { s.name }{ (anointmentsInSpecialization[s.abbreviation] > 0) && (\" (\" + anointmentsInSpecialization[s.abbreviation] + \")\") }\n                </div>\n\n              )\n            }\n          </nav>\n          <div className=\"specialization-selection-list\">   \n             <h2>{this.state.currentSpecialization && this.state.currentSpecialization.name} Perks</h2> \n              <table id=\"perks-table\" className={this.props.atMaxAnointments ? \"max-anoints\" : \"\"}>\n                <thead>\n                  <tr>\n                    <th></th>\n                    <th>Perk Name</th>\n                    <th>Description</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {\n                    this.state.currentSpecialization && this.state.currentSpecialization.perks.map ((perk, i) =>\n                      <tr key={i} onClick={() => this.props.toggleAnointment(perk)}\n                          className={(anointmentNames.has(perk.name) ? \"active\" : \"\") + (perk.anointment === \"Yes\" ? \"\" : \"no-anoint\")}\n                          title={perk.anointment === \"No\" ? \"This perk cannot be selected as an anointment.\" : undefined}\n\n                          >\n                        <td>{ anointmentNames.has(perk.name) && <span className=\"green-tick\"><FontAwesomeIcon icon={faCheck}/></span>}</td>\n                        <td>{perk.name}</td>\n                        <td>{perk.description}</td>\n                      </tr>\n                  )}\n\n                </tbody>\n              </table>\n              <section className=\"flavour-text\">\n                <h4>About the {this.state.currentSpecialization && this.state.currentSpecialization.name}</h4>\n                {this.state.currentSpecialization && this.state.currentSpecialization.description.split('\\\\n').map((par, i) => \n                  (<p key={i}>{par}</p>)\n                )}\n              </section>\n          </div>\n        </div>  \n      </Modal>\n\n    )\n  }\n}\n\n\n/**\n * A single Anointment that appears in the list of anointments\n * on the Specializations tab on the left side.\n * Note that this has nothing to do with the Anointments modal.\n * @\n */\nclass SpecializationPlannerAnointment extends PureComponent {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      justUpdated: false,\n    }\n  }\n\n  /**\n   * Render an empty row that says \"No anointment selected\".\n   * @return {ReactElement} An empty row.\n   */\n  renderEmptyRow() {\n    return (<div className=\"empty-row\">No anointment selected</div>)\n  }\n\n  /**\n   * The render function.\n   * @return {ReactComponent} A div representing an anointment.\n   */\n  render() {\n    const rowErrors = null;\n\n    return (\n    <div className=\"trait-slot anointment-slot\">\n      <div\n        className={\"anointment-slot-non-clickable\" + \n          (rowErrors ? \" invalid-row\" : \"\") + \n          (this.state.justUpdated ? \" just-updated\": \"\")\n        }\n        title={rowErrors }\n      >\n      { !this.props.perk ? this.renderEmptyRow() :\n        <div className=\"anointment\">\n          <div className=\"anointment-name-and-source\">\n            <div className=\"anointment-name\">            \n            {this.props.perk.name}\n            </div>\n            <div className=\"anointment-source\">\n              (<span className=\"option-icon\" style={{\"backgroundImage\": \"url(/siralim-planner/specialization_icons/\" + this.props.perk.spec_abbrev + \".png)\"}}>\n                </span> {this.props.perk.spec})\n            </div>\n          </div>\n          <div className=\"anointment-desc\">{this.props.perk.description}</div>\n        </div>\n      }\n      </div>\n    </div>\n    )\n  }\n}\n\n\n\n\n/**\n * The specialization planner, which appears as a box on the left hand side of the page.\n * Allows the user to select their specialization and anointments.\n * @property {Boolean} state.isOpen Whether the planner is open (true), or pushed to the side (false).\n * @property {Array} state.specializations A list of all specializations, which are copied over from \n *                                         specializationsList and updated with values and labels for react-select.\n * @property {Boolean} state.anointmentsModalIsOpen Whether or not the anointments modal is open.\n */\nclass SpecializationPlanner extends PureComponent {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpen: true,\n      specializations: [],\n\n      anointmentsModalIsOpen: false,\n    }\n  }\n\n  /**\n   * Toggle whether this is open (or pushed to the side).\n   */\n  toggleOpen() {\n    this.setState({\n      isOpen: !this.state.isOpen\n    })\n  }\n\n  /**\n   * When this component mounts, copy over the specializations from the global specializationsList\n   * and append value and labels, which are required for react-select.\n   */\n  componentDidMount() {\n    let specializations = [...specializationsList];\n    for(let s of specializations) {\n      s['value'] = s.abbreviation;\n      s['label'] = s.name;\n    }\n\n    this.setState({\n      specializations: specializations,\n    })\n  }\n\n\n  /**\n   * Close the anointments modal and allow scrolling in the document body.\n   */\n  closeAnointmentsModal() {\n    this.setState({\n      anointmentsModalIsOpen: false,\n    }, () => {\n      document.body.style['overflow-y'] = \"scroll\";\n    })\n  }\n\n  /**\n   * Open the anointments modal and prevent scrolling in the document body.\n   */\n  openAnointmentsModal() {\n    this.setState({\n      anointmentsModalIsOpen: true,\n    }, () => {\n      document.body.style['overflow-y'] = \"hidden\";\n    })\n  }\n\n\n  /**\n   * Handle a specialization change, i.e. the user has selected a different\n   * specialization in the drop down list.\n   * @param  {Object} selectedOption The selected option from react-select.\n   */\n  handleSpecializationChange(selectedOption) {\n    let currentSpecialization = null;\n    for(let s of this.state.specializations) {\n      if(s.abbreviation === selectedOption.value) {\n        currentSpecialization = s;\n        break;\n      }\n    }\n    this.props.updateSpecialization(currentSpecialization);\n  }\n\n\n  /**\n   * The render function.\n   * @return {ReactComponent} The specialization planner div.\n   */\n  render() {\n\n    const freeAnointmentSlots = new Array(Math.max(0, this.props.maxAnointments - this.props.anointments.length)).fill(null); // TODO: Get this to work for Royal\n\n    let specOptions = [];\n    for(let s of this.state.specializations) {\n      specOptions.push({ value: s.abbreviation, label: s.name });\n    }\n\n    return (\n      <div id=\"specialization-planner\" className={(!this.state.isOpen ? \"hide \" : \"\") +\n        \"spe-\" + (this.props.currentSpecialization && this.props.currentSpecialization.abbreviation)}>\n\n        <div className=\"toggle-bar\" onClick={this.toggleOpen.bind(this)}>\n          <FontAwesomeIcon icon={(this.state.isOpen ? faChevronLeft : faChevronRight)}/>\n        </div>\n\n        <SpecializationPlannerAnointmentsModal \n          modalIsOpen={this.state.anointmentsModalIsOpen}\n          closeModal={this.closeAnointmentsModal.bind(this)}\n\n          anointments={this.props.anointments}\n          specializations={this.state.specializations}\n          specOptions={specOptions}\n          currentSpecialization={this.props.currentSpecialization}\n\n          maxAnointments={this.props.maxAnointments}\n          atMaxAnointments={this.props.maxAnointments === this.props.anointments.length}\n\n          toggleAnointment={this.props.toggleAnointment}\n        />\n\n        <h3 className=\"section-title\">Specialization</h3>\n\n        <Select \n            styles={customStyles}\n            value={this.props.currentSpecialization}\n            onChange={this.handleSpecializationChange.bind(this)}\n            options={specOptions}\n            menuPosition=\"fixed\"\n            components={{ Option: IconOption, ValueContainer: MyValueContainer }}\n          />\n\n\n        <button aria-label=\"View specializations\" className=\"perks-and-anointments-button\" onClick={() => this.openAnointmentsModal()}>\n          <FontAwesomeIcon icon={faBolt}/>Anointments\n        </button>\n\n        <div className=\"anointments-list\">\n        { this.props.anointments.map((anointment, i) =>\n          <SpecializationPlannerAnointment key={i} perk={anointment}/>\n        )}\n        { freeAnointmentSlots.map((anointment, i) =>\n          <SpecializationPlannerAnointment key={i} perk={anointment}/>\n        )}\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default SpecializationPlanner;","/**\n * A function to parse the character section of a build string from Siralim Ultimate.\n * @param  {String} text The character section of the build string.\n * @return {{String, Array}}      The specialization and list of the names of the anointments\n *                                from the build string.\n */\nfunction parseCharacterSection(text) {\n\n  let spec = '';\n  let anointment_names = [];\n\n  for(const line of text.split('\\n')) {\n    if(line.indexOf(\"the \") !== -1 && !spec) {\n      spec = line.split(\"the \")[1];\n    } else if (line.indexOf('Anointments: ') !== -1) {\n      anointment_names = line.split('Anointments: ')[1].split(', ');\n    }\n  }\n  let an_set = new Set(anointment_names);\n  if(an_set.size !== anointment_names.length) throw new Error(\"Duplicate anointment.\")\n\n  if(anointment_names.length > 15) throw new Error(\"Too many anointments.\");\n  if(spec !== \"Royal\" && anointment_names.length > 5) throw new Error(\"Too many anointments.\");\n\n\n  return { spec: spec, anointment_names: anointment_names};\n\n}\n\n\n/**\n * A function to parse the creature section of a build string from Siralim Ultimate.\n * Function written by bluequakeralex and adapted by beratedbert.\n * @param  {String} text The creature section of the build string.\n * @return {Array}      An array of 18 (or fewer) trait names.\n */\nfunction parseCreatureSection(text) {  \n\n  let innates = [];\n  let secondaries = [];\n  let artifacts = [];\n\n  const innateDetectionText = \"Innate Trait: \";\n  const fusedDetectionText = \"Fused Trait: \";\n  const traitSlotDetectionText = \"Trait Slot: \";\n\n  // Split into creatures using the ---- lines.\n  // Hopefully this does not change between patches.\n  let creatures = text.split('------------------------------');\n  if(creatures.length > 7) throw new Error(\"Party appears to have more than 6 creatures.\");\n\n  creatures = creatures.slice(0, 6); // Remove the last element, which is empty space after the last\n                                     // dashed line.\n\n  innates = new Array(6).fill(null);\n  secondaries = new Array(6).fill(null);\n  artifacts = new Array(6).fill(null);\n\n  // For each creature, get the innate, secondary and artifact trait.\n  // Throw an error if a creature has more than one of each trait type.\n  // If the creature does not have a trait in that slot, it will be null.\n  for(let i = 0; i < 6; i++) {\n\n    if(!creatures[i]) continue;\n\n    let innateTrait = null;\n    let secondaryTrait = null;\n    let artifactTrait = null;\n\n    let lines = creatures[i].split('\\n');\n\n    for (const line of lines) {\n      if (line.startsWith(innateDetectionText)) {\n        if(innateTrait) throw new Error(\"Creature #\" + (i + 1) + \" has more than one primary trait.\")\n        innateTrait = line.slice(innateDetectionText.length);\n      }\n      else if (line.startsWith(fusedDetectionText)) {\n        if(secondaryTrait) throw new Error(\"Creature #\" + (i + 1) + \" has more than one secondary trait.\")\n        secondaryTrait = line.slice(fusedDetectionText.length);\n      }\n      else if (line.startsWith(traitSlotDetectionText)) {\n        if(artifactTrait) throw new Error(\"Creature #\" + (i + 1) + \" has more than one artifact trait.\")\n        artifactTrait = line.slice(traitSlotDetectionText.length).split(\":\")[0];\n      }\n    }\n    innates[i] = innateTrait;\n    secondaries[i] = secondaryTrait;\n    artifacts[i] = artifactTrait;\n  }\n\n  let traitsArray = [];\n\n  for (let i = 0; i < 6; i++) {\n    const innate = innates[i];\n    const fusion = secondaries[i];\n    const artifact = artifacts[i];\n\n    traitsArray.push(innate);\n    traitsArray.push(fusion);\n    traitsArray.push(artifact);\n  }\n\n  let atLeastOne;\n  for(let i = 0; i < traitsArray.length; i++) {\n    if(traitsArray[i]) atLeastOne = true;\n  }\n  if(!atLeastOne) throw new Error(\"The party string does not appear to contain any traits.\")\n\n  return traitsArray;\n\n}\n\n/**\n * A function to parse the build string from the export feature in Siralim Ultimate.\n * @param  {String} text The build string.\n * @return {{Array, String, Array}}      The list of trait names, specialization name, and anointment names.\n */\nfunction parsePartyString(text) {\n\n  if(text.indexOf('========== CREATURES ==========') === -1) {\n    throw new Error(\"The string does not appear to be a valid Siralim Ultimate build string.\")\n  }\n\n  const sections = text.split('========== CREATURES ==========')\n  \n  const {spec, anointment_names} = parseCharacterSection(sections[0]);\n  const traitsArray = parseCreatureSection(sections[1]);\n\n  return {traits: traitsArray, spec: spec, anointment_names: anointment_names};\n}\n\nexport default parsePartyString;","import React, {Component} from 'react';\nimport Modal from 'react-modal';\nimport { withRouter } from \"react-router-dom\";\nimport _ from 'underscore';\n\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faCheck } from '@fortawesome/free-solid-svg-icons'\nimport { faExclamationTriangle } from '@fortawesome/free-solid-svg-icons'\n\nimport InfoModal from './components/InfoModal'\nimport UploadPartyModal from './components/UploadPartyModal'\n\nimport AppHeader from './components/AppHeader'\nimport AppFooter from './components/AppFooter'\n\nimport MonsterSelectionModal from './components/MonsterSelectionModal'\nimport MonsterPlanner from './components/MonsterPlanner'\nimport SpecializationPlanner from './components/SpecializationPlanner'\n\nimport parsePartyString from './functions/parsePartyString';\n\nimport './App.scss';\n\nModal.setAppElement(\"#root\");\n\nconst UID_HASH_LENGTH = 6;\nconst monsterData = require('./data/data');\nconst specializationsList = require('./data/specializations');\nconst metadata = require('./data/metadata');\nconst compendium_version = metadata.compendium_version;\n\n\n/**\n * Construct a map (i.e. a JSON dictionary) that maps UIDs to the index\n * of that UID in traitsList.\n * @return {Object} A map of {uid: index}\n */\nfunction buildUIDMap() {\n  let monsterMap = {}\n  for(let i in monsterData) {\n    monsterMap[monsterData[i].uid] = parseInt(i);\n  }\n  return monsterMap;\n}\n\n/**\n * Construct a map (i.e. a JSON dictionary) that maps lowercased trait_names to\n * the UIDs in the database. This is necessary to import party strings.\n * @return {Object} A map of {trait_name: uid}\n */\nfunction buildTraitMap() {\n  let traitMap = {}\n  for(let i in monsterData) {\n    traitMap[monsterData[i].trait_name.toLowerCase()] = monsterData[i].uid;\n  }\n  return traitMap;\n}\n\n/**\n * Construct two maps: one mapping anointment UIDs (BMA, BMB etc) to the corresponding\n * perk, and another mapping anointment names (Union, Whetbone etc) to the corresponding\n * perk.\n * @return {Object} An object containing the anointment UID map and anointment name map.\n */\nfunction buildAnointmentMaps() {\n  let anointmentUIDMap = {}\n  let anointmentNameMap = {}\n  for(let s of specializationsList) {\n    for(let p of s.perks) {\n      if(p.anointment === \"No\") continue;\n      anointmentUIDMap[p.uid] = p;\n      anointmentNameMap[p.name] = p;\n    }\n  }\n  return {anointmentUIDMap: anointmentUIDMap, anointmentNameMap: anointmentNameMap};\n}\n\n/**\n * Construct a map that maps specialization names to the specialization objects.\n * @return {Object} A map of {specialization name: specialization object}\n */\nfunction buildSpecializationNameMap() {\n  let specializationNameMap = {};\n  for(let s of specializationsList) {\n    specializationNameMap[s.name] = s;\n  }\n  return specializationNameMap;  \n}\n\nconst monsterUIDMap = buildUIDMap();\nconst monsterTraitMap = buildTraitMap();\nconst {anointmentUIDMap, anointmentNameMap} = buildAnointmentMaps();\nconst specializationNameMap = buildSpecializationNameMap();\n\n\n/**\n * A class representing the notification banner, which appears at the top when\n * a notification is made in the SiralimPlanner app.\n * @property {Boolean} state.hidden Whether this banner is currently hidden or not.\n */\nclass NotificationBanner extends Component {\n\n  /**\n   * Class constructor.\n   * @param  {Object} props The props.\n   * @return {void}\n   */\n  constructor(props) {\n    super(props);\n    this.state = {\n      hidden: true,\n    };\n    this.fadeOutTimeout = null;\n  }\n\n  /**\n   * When this component updates such that the prevProps are different\n   * and this notification banner was not already showing, set hidden=false\n   * (so the banner appears) and set a timeout for 6s for it to hide again.\n   * @param  {Object} prevProps The previous props.\n   * @param  {Object} prevState The previous state.\n   * @return {void}\n   */\n  componentDidUpdate(prevProps, prevState) {\n    if(_.isEqual(prevProps, this.props) && prevState.hidden === false) return;\n    if(this.props.status === null) return; // Ignore first successful load, which is null.\n    if(prevProps.notificationIndex === this.props.notificationIndex) return;\n\n    this.setState({\n      hidden: false,\n    }, () => {\n      window.clearTimeout(this.fadeOutTimeout);\n      this.fadeOutTimeout = window.setTimeout( () => this.setHidden(), 6000);\n    });    \n  }\n  \n  /**\n   * Hide the notification banner (this sets the opacity to 0 via CSS so that\n   * way nothing gets moved around awkwardly.)\n   */\n  setHidden() {\n    this.setState({\n      hidden: true,\n    })\n  }\n\n  /**\n   * The render function\n   * @return {ReactComponent} The notification banner component.\n   */\n  render() {\n    let icon = faExclamationTriangle;\n    if(this.props.status === \"success\") icon = faCheck;\n\n    return (\n    <div className={\"notification-banner notification-\" + this.props.status + (this.state.hidden ? \" hidden\" : \"\")}>\n        <FontAwesomeIcon icon={icon}/>&nbsp;&nbsp;{this.props.text}\n    </div>\n    )\n\n  }\n}\n\n\n/**\n * The main component which sits within App.\n * @property state.partyMembers {Array}  A list of 6 items, each of which corresponds to a party member.\n * @property state.anointments  {Array}  A list of the 5 anointments (or 15 if Royal) the user has selected.\n * @property {Object} state.currentSpecialization    The currently selected specialization.\n * @property {Integer} state.maxAnointments The maximum number of anointments. Is changed to 15 when spec = Royal\n * @property {Integer} state.currentPartyMemberId The current party member id, i.e. 0, 1, 2, 3, 4 or 5.\n * @property {Integer} state.currentTraitSlotId The current party trait slot id, i.e. 0, 1 or 2.\n * @property {Integer} state.currentSlotId The current slot id, i.e. the slot the user most recently\n *                                      clicked on in the party planning interface.\n *                                      slot id = 0 means the first row in the table.\n * @property {Object} state.currentSelectedMonster A JSON obj corresponding to the monster that is currently\n *                                           selected, i.e. the one the user most recently clicked in\n *                                           the party planning interface.\n * @property {Set} state.monstersInParty An set of uids of the monsters/trait in the user's party.\n * @property {Boolean} state.modalIsOpen Whether the monster selection modal is open.\n * @property {Boolean} state.infoModalIsOpen Whether the information modal is open.\n * @property {Boolean} state.uploadBuildModalIsOpen Whether the upload build modal is open.\n * @property {String} state.notificationText Text to display in the notification banner at the top.\n * @property {String} state.notificationStatus The status of the notification, e.g. 'success', 'warning', 'error'.\n * @property {Integer} state.notificationIndex Keep track of the index of each notification, to avoid weird bugs with the\n *                                       banner refreshing for no reason when this component updates.\n *                                      \n */\nclass SiralimPlanner extends Component {\n\n  /**\n   * The constructor.\n   * @param  {Object} props The props.\n   */\n  constructor(props) {\n    super(props);\n    this.state = {\n\n      partyMembers: [],\n      anointments:  [],\n      currentSpecialization: null,\n      maxAnointments: 5,\n\n      currentPartyMemberId: null,\n      currentTraitSlotId:   null,\n      currentSlotId: null,\n      currentSelectedMonster: null,\n\n      monstersInParty: new Set(),\n      modalIsOpen: false,\n      infoModalIsOpen: false,\n      uploadBuildModalIsOpen: false,\n\n      notificationText: null,\n      notificationStatus: null,\n      notificationIndex: 0,\n    }    \n  }\n\n\n\n  /**\n   * Generate a 'save string', which is a unique identifier of the entire party.\n   * This is done by taking the uid of each monster (underscore if no monster)\n   * across each of the 18 slots.\n   * Note that the string is quite long, and will be even longer if we later add\n   * in other things like traits, perks etc... so we might need to develop a \n   * back-end application like Flask to be able to generate a short URL.\n   */\n  generateSaveString() {\n    let partyMembers = this.state.partyMembers;\n    let saveString = \"\";\n\n    var c = 0;\n    for(let pm of partyMembers) {\n      for(let m of pm) {\n        if(!_.isEmpty(m.monster)) saveString += m.monster.uid;\n        else saveString += \"_\";\n        c++;\n        if(c > 18) break;\n      }\n    }\n\n    // Generate specialization string\n    if(this.state.currentSpecialization) {\n      saveString += \"&s=\" + this.state.currentSpecialization.abbreviation;\n    }\n\n    if(this.state.anointments.length > 0) saveString += \"&a=\"\n    // Generate anointments string\n    for(let a of this.state.anointments) {\n      saveString += a.uid;\n    }\n\n    this.props.history.push('?b=' + saveString);\n  }\n\n  \n  /**\n   * Retrieve a set of the uids of every monster/trait (up to 18) in the current party.\n   * @param  {Array} partyMembers An array of Objects where each object is a party member.\n   * @return {Array}              An array of the uid of each monster/trait in the party.\n   */\n  getMonstersInParty(partyMembers) {\n    let monstersInParty = new Set();\n    for(let p of partyMembers) {\n      for(let m of p) {\n        if(m.monster.uid) monstersInParty.add(m.monster.uid);\n      }\n    }\n    return monstersInParty;\n  }\n\n\n  \n  /**\n   * Given a particular monster, update the monster at the party member and trait slot id\n   * to be set to that monster.\n   * @param  {Object} monster The monster to replace the current monster with.\n   */\n  updatePartyMember(monster) {\n    let partyMembers = [...this.state.partyMembers];\n    partyMembers[this.state.currentPartyMemberId][this.state.currentTraitSlotId].monster = monster;\n\n    let monstersInParty = this.getMonstersInParty(partyMembers);\n    this.setState({\n      partyMembers: [...partyMembers],\n      monstersInParty: monstersInParty\n    }, () => { \n      this.closeModal(); \n      this.generateSaveString();\n    })\n  }\n\n\n  /**\n   * Given a particular partyMemberId and traitSlotId, e.g. 1, 4, \n   * remove that monster/trait from the party.\n   * @param  {Integer} partyMemberId The id of the party member, e.g. 1.\n   * @param  {Integer} traitSlotId   The id of the trait slot, e.g. 4.\n   */\n  clearPartyMember(partyMemberId, traitSlotId) {\n    let partyMembers = [...this.state.partyMembers];\n    partyMembers[partyMemberId][traitSlotId].monster = {};\n    let monstersInParty = this.getMonstersInParty(partyMembers);\n\n    this.setState({\n      partyMembers: partyMembers,\n      monstersInParty: monstersInParty,\n    }, this.generateSaveString)\n  }\n\n  \n  /**\n   * Update the 18 monster planner rows to newRows and generate an updated\n   * saveString.\n   * @param  {Array} newMembers An array of monster objects.\n   */\n  updatePartyMembers(newMembers) {\n    this.setState({\n      partyMembers: newMembers,\n    }, this.generateSaveString);\n  }\n\n  /**\n   * Update the anointments array to newAnointments and generate an updated\n   * saveString.\n   * @param  {Array} newAnointments An array of anointment objects.\n   */\n  updateAnointments(newAnointments) {\n    this.setState({\n      anointments: newAnointments\n    }, this.generateSaveString);\n  }\n\n  /**\n   * Parse the loadString into a list of UIDs (or null for underscores).\n   * @param  {String} str The string to parse.\n   * @return {Array}     An array of strings, where each string is a uid.\n   */\n  parseLoadString(str) {\n  \tlet uids = [];\n  \tlet currentUid = '';\n  \tfor(let i = 0; i < str.length; i++) {\n  \t\tlet c = str[i];\n  \t\tif(c === \"_\") {\n  \t\t\tif(currentUid.length > 0 && currentUid.length < UID_HASH_LENGTH) throw new Error(\"Malformed uid\");\n  \t\t\tuids.push(null);\n  \t\t} else {\n  \t\t\tcurrentUid += c;\n  \t\t\tif(currentUid.length === UID_HASH_LENGTH) {\n  \t\t\t\tuids.push(currentUid);\n  \t\t\t\tcurrentUid = '';\n  \t\t\t}\n  \t\t}\n  \t}\n    // Throw errors if the string is not valid (i.e. too short or too long).\n  \tif(uids.length > 18) throw new Error(\"Too many uids\");\n  \tif(uids.length < 18) throw new Error(\"Not enough uids\");\n\n  \treturn uids;\n  }\n\n\n  /**\n   * Parse the spec string (should contain two letters corresponding to\n   * a specialization) and return the specialization in the string.\n   * @param  {String} str The string to parse.\n   * @return {Object}     The specialization object.\n   * @throws {Error} If specialization is not found.\n   */\n  parseSpecString(str) {\n\n    for(let s of specializationsList) {\n      if(s.abbreviation === str) {\n        return s;\n      }\n    }\n    throw new Error(\"Specialization not found\");\n  }\n\n  /**\n   * Parse the anointments string and return a list of anointments\n   * whose uids are in the string.\n   * @param  {String} str The string to parse.\n   * @return {Array} The array of anointment objects.\n   * @throws {Error} If the string is not valid.\n   */\n  parseAnointmentsString(str) {\n    let anointments = [];\n    let a_uids = str.match(/.{1,3}/g);\n    let seen_uids = new Set();\n    for(let a of a_uids) {\n      if(a.length !== 3) throw new Error(\"Anointment string contains invalid anointment id.\");\n      if(!anointmentUIDMap.hasOwnProperty(a)) throw new Error(\"Anointment id not found.\");\n      if(seen_uids.has(a)) throw new Error(\"Anointment appears twice.\");\n      seen_uids.add(a);\n\n      anointments.push(anointmentUIDMap[a]);\n    }\n    return anointments;\n  }\n\n  /**\n   * Given a list of uids, construct a new array of monsterPlannerRows\n   * where each item is the monster that corresponds to that particular\n   * uid. This is used to read in the buildString (from the URL) and\n   * from the in-game export of data to the clipboard.\n   *\n   * Returns a json object with the 18 rows, any notification message that pops up\n   * (right now just that the build could not be parsed or that it was parsed\n   * successfully), and a status code\n   * (warning, success, error, null).\n   * @param  {Array} uids An array of strings, where each string is a uid.\n   * @return {{Array, String, String}}      An array of party members, the notification text,\n   *                                        and notification status.\n   */\n  populateFromUids(uids) {\n\n    let noti, status;\n    //let monsterPlannerRows = [];\n    let partyMembers = [];\n    // Start by generating an empty list of 18 rows, corresponding to each\n    // trait slot.\n\n    for(let i = 0; i < 6; i++) {\n      partyMembers.push([]);\n      for(let j = 0; j < 3; j++) {\n        partyMembers[i].push({ monster: {} })\n      }\n    }\n\n    for(let i = 0; i < Math.min(18, uids.length); i++) {\n      let uid = uids[i];\n      if(uid !== null) {\n        if(monsterUIDMap.hasOwnProperty(uid)) {\n          partyMembers[Math.floor(i / 3)][i % 3].monster = monsterData[monsterUIDMap[uid]];\n        } else {\n          partyMembers[Math.floor(i / 3)][i % 3].error = \"Monster/trait does not exist or has changed\";\n          noti = \"Your build could not be fully parsed as at least one monster trait was not found in the database.\";\n          status = \"warning\";\n        }\n      }\n    }\n    if(!noti) {\n      noti = \"Your build was parsed successfully.\";\n      status = \"success\";\n    }\n    return {partyMembers: partyMembers, noti: noti, status: status};\n  }\n\n  /**\n   * On component mount, transform monsterData into a new array, i.e.\n   * { row_id: <the index of the monster>, monster: <the JSON object of the monster> }\n   * This is necessary to get the drag and drop functionality to work.\n   * Every row needs a fixed id to function properly.\n   */\n  componentDidMount() {\n\n    let notificationText = null;\n    let notificationStatus = null;\n\n    let partyMembers = [];\n\n    for(let i = 0; i < 6; i++) {\n      partyMembers.push([]);\n      for(let j = 0; j < 3; j++) {\n        partyMembers[i].push({ monster: {} })\n      }\n    }\n\n    // Get string from param if there is any\n    const windowUrl = window.location.search;\n    const params = new URLSearchParams(windowUrl);\n\n    let loadString = params.get('b');\n\n    // If a load string was provided (i.e. the ?b=<etc>), then attempt to create a party from that\n    // build string.\n    if(loadString) {\n      try {\n     \t\tconst uids = this.parseLoadString(loadString);\n        let pm = this.populateFromUids(uids);\n        if(pm.status !== 'success') {\n          notificationText = pm.noti;\n          notificationStatus = pm.status;\n        }\n        partyMembers = pm.partyMembers;\n\n     \t} catch(err) {\n        // TODO: Do something else with this, maybe.\n     \t\tconsole.log(\"Error:\", err);\n     \t}\n    }\n\n    // Parse specialization string (s)\n    let specialization = this.state.specialization;\n    let specString = params.get('s');\n    if(specString) {\n      try {\n        specialization = this.parseSpecString(specString);\n      } catch(err) {\n        notificationText = \"Error parsing specialization in URL: \" + err.message;\n        notificationStatus = \"error\";\n      }\n    }\n\n    // Parse anointment string (a)\n    let anointments = this.state.anointments;\n    let anointmentString = params.get('a');\n    if(anointmentString) {\n      try {\n        anointments = this.parseAnointmentsString(anointmentString);\n      } catch(err) {\n        notificationText = \"Error parsing anointments in URL: \" + err.message;\n        notificationStatus = \"error\";\n      }\n    }\n    if(specialization && specialization.name !== \"Royal\" && anointments.length > 5) {\n      anointments = anointments.slice(0, 5);\n    }\n\n\n    this.setState({\n      anointments: anointments,\n      currentSpecialization: specialization,\n      partyMembers: partyMembers,\n      notificationText: notificationText,\n      notificationStatus: notificationStatus,\n      notificationIndex: this.state.notificationIndex + 1,\n    });\n  }\n\n\n  /**\n   * Open the build modal by setting the state accordingly.\n   */\n  openUploadBuildModal() {\n    this.setState({\n      uploadBuildModalIsOpen: true,\n    })\n  }\n\n  \n  /**\n   * Close the build modal by setting the state accordingly.\n   */\n  closeUploadBuildModal() {\n    this.setState({\n      uploadBuildModalIsOpen: false,\n    })\n  }\n\n  /**\n   * Open the info modal by setting the state accordingly.\n   */\n  openInfoModal() {\n  \tthis.setState({\n  \t\tinfoModalIsOpen: true,\n  \t})\n  }\n\n  /**\n   * Close the info modal by setting the state accordingly.\n   */\n  closeInfoModal() {\n  \tthis.setState({\n  \t\tinfoModalIsOpen: false,\n  \t})\n  }\n\n  // Open the monster selection modal.\n  // Set row_id and slot_id to the row_id and slot_id of the trait slot\n  // that the user clicked on, respectively.\n  // Set monster to equal the monster the user just clicked on\n  // (this is necessary to highlight the currently selected monster\n  // in the monster selection screen).\n  \n\n  /**\n   * Open the monster selection modal.\n   * Set row_id and slot_id to the row_id and slot_id of the trait slot\n   * that the user clicked on, respectively.\n   * Set monster to equal the monster the user just clicked on\n   * (this is necessary to highlight the currently selected monster\n   * in the monster selection screen).\n   * @param  {Integer} partyMemberId The id of the party member, e.g. 1.\n   * @param  {Integer} traitSlotId   The id of the trait slot, e.g. 4.\n   * @param  {Object} monster       The monster object.\n   */\n  openModal(partyMemberId, traitSlotId, monster) {\n    this.setState({\n      modalIsOpen: true,\n      currentPartyMemberId: partyMemberId,\n      currentTraitSlotId: traitSlotId,\n      currentSelectedMonster: monster || null,\n    }, () => {\n      // Once open, prevent scrolling of the main page while the modal is open.\n      document.body.style['overflow-y'] = \"hidden\";\n      document.getElementById('monster-search').focus();\n    })\n  }\n\n\n  /**\n   * Close the monster selection modal.\n   * Enable scrolling of the main page again after it closes.\n   */\n  closeModal() {\n    this.setState({\n      modalIsOpen: false,\n      currentPartyMemberId: null,\n      currentTraitSlotId: null,\n      currentSelectedMonster: null,\n    }, () => {\n      document.body.style['overflow-y'] = \"scroll\";\n    })\n  }\n\n\n  // Given an array of trait names, return an array\n  // consisting of the uids of those particular trait names,\n  // null if there was no trait in that slot, \n  // or <not found> if that trait name is not present in the \n  // trait map.\n  \n  /**\n   * Given an array of trait names, return an array\n   * consisting of the uids of those particular trait names,\n   * null if there was no trait in that slot, \n   * or <not found> if that trait name is not present in the \n   * trait map.\n   * @param  {Array} traitsArray An array of trait names.\n   * @return {Array}             An array of the uids of those trait names.\n   */\n  traitsToUids(traitsArray) {\n    let uids = [];\n    for(let t of traitsArray) {\n      if(t === null) {\n        uids.push(null);\n        continue;\n      }\n      let t_ = t.toLowerCase();\n      if(monsterTraitMap.hasOwnProperty(t_)) {\n        uids.push(monsterTraitMap[t_]);\n      } else {\n        uids.push(\"<not found>\");\n      }\n    }\n    return uids;\n  }\n\n\n  /**\n   * Given a party string (from SU), build a party from that string.\n   * Call the callback function when finished - this will present an error\n   * in the upload party window if necessary.\n   * @param  {String}   str      The party string.\n   * @param  {Function} callback The function to call when complete.\n   */\n  uploadPartyFromString(str, callback) {\n    let notificationText = null;\n    let notificationStatus = null;\n\n    try {\n      let {traits, spec, anointment_names} = parsePartyString(str);\n      let uids = this.traitsToUids(traits);\n      let pm = this.populateFromUids(uids);\n      if(pm.noti) notificationText = pm.noti;\n      if(pm.status) notificationStatus = pm.status;\n      let partyMembers = pm.partyMembers;\n\n      if(!specializationNameMap.hasOwnProperty(spec)) {\n        throw new Error(\"Specialization \\\"\" + spec + \"\\\" was not found.\");\n      }\n      const specialization = specializationNameMap[spec];\n\n      let anointments = [];\n      for(let a of anointment_names) {\n        if(anointmentNameMap.hasOwnProperty(a)) {\n          anointments.push(anointmentNameMap[a]);\n        } else {\n          notificationText = \"Your build was loaded, but anointment \\\"\" + a + \"\\\" was not found.\";\n          notificationStatus = \"warning\";          \n          //anointments.push(null) // Note: This should ideally push an error or something\n                                 // and render it the same way it does with the party members\n                                 // whose traits do not exist.\n        }\n      }\n      anointments.slice(0, specialization.name === \"Royal\" ? 15 : 5);\n\n      this.setState({\n        partyMembers: partyMembers,\n        uploadBuildModalIsOpen: false,\n        currentSpecialization: specialization,\n        anointments: anointments,\n        notificationText: notificationText,\n        notificationStatus: notificationStatus,\n        notificationIndex: this.state.notificationIndex + 1,\n      }, () => { this.generateSaveString(); callback() });\n    } catch(err) {\n      return callback(err);\n    }\n\n    // TODO: Take the traits and put them into the table etc.\n  }\n\n  /**\n   * Toggle an anointment, i.e. enable or disable it.\n   * @param  {Object} anointment The anointment to toggle.\n   */\n  toggleAnointment(anointment) {\n    if(anointment.anointment !== \"Yes\") return;\n    \n    let anointments = this.state.anointments;\n    let deleted = false;\n    for(let i = 0; i < anointments.length; i++) {\n      const a = anointments[i];\n      // If this anointment in list, remove it and add a null at the end.\n      if(anointment.name === a.name) {\n        anointments.splice(i, 1);\n        deleted = true;\n        break;\n      }\n    }\n    if(!deleted) {      \n      let limit = 5;\n      if(this.state.currentSpecialization.name === \"Royal\") {\n        limit = 15;\n      }\n      if(anointments.length < limit) {\n        anointments.push(anointment);\n      }\n    }\n    this.setState({\n      anointments: anointments,\n    }, this.generateSaveString);\n  }\n\n  /**\n   * Update the Specialization based on the selected option from the react select component.\n   * @param  {obj} s The specialization to update to.\n   * @return {void}   \n   */\n  updateSpecialization(s) {\n    const maxAnointments = s.name === \"Royal\" ? 15 : 5;\n    let anointments = this.state.anointments;\n    if(anointments.length > maxAnointments) {\n      anointments = anointments.slice(0, maxAnointments);\n    }\n    this.setState({\n      anointments: anointments,\n      currentSpecialization: s,\n      maxAnointments: maxAnointments,\n    }, this.generateSaveString)\n  }\n\n\n  /**\n   * The render function.\n   * @return {ReactComponent} The main div containing the app.\n   */\n  render() {\n    return (\n      <div className=\"App\" id=\"app\">\n        <AppHeader openUploadBuildModal={this.openUploadBuildModal.bind(this)} openInfoModal={this.openInfoModal.bind(this)} compendiumVersion={compendium_version}/>\n        <NotificationBanner text={this.state.notificationText} status={this.state.notificationStatus} notificationIndex={this.state.notificationIndex} />\n\n        <UploadPartyModal modalIsOpen={this.state.uploadBuildModalIsOpen} closeModal={this.closeUploadBuildModal.bind(this)} uploadPartyFromString={this.uploadPartyFromString.bind(this)}/>\n        <InfoModal modalIsOpen={this.state.infoModalIsOpen} closeModal={this.closeInfoModal.bind(this)}/>\n\n        <div className={\"modal-overlay\" + (this.state.modalIsOpen ? \" is-open\" : \"\")}>\n          <MonsterSelectionModal \n            items={monsterData}\n            monstersInParty={this.state.monstersInParty}\n            closeModal={this.closeModal.bind(this)}\n            updatePartyMember={this.updatePartyMember.bind(this)} \n            currentSelectedMonster={this.state.currentSelectedMonster} \n\n            currentPartyMemberId = {this.state.currentPartyMemberId}\n            currentTraitSlotId = {this.state.currentTraitSlotId} />\n        </div>\n\n        <main>\n          <SpecializationPlanner\n            currentSpecialization={this.state.currentSpecialization}\n            anointments={this.state.anointments}\n            maxAnointments={this.state.maxAnointments}\n            updateSpecialization={this.updateSpecialization.bind(this)}\n            updateAnointments={this.updateAnointments.bind(this)}\n            toggleAnointment={this.toggleAnointment.bind(this)}\n          />\n          <MonsterPlanner \n            partyMembers={this.state.partyMembers}\n            updatePartyMembers={this.updatePartyMembers.bind(this)}\n            openModal={this.openModal.bind(this)}\n            clearPartyMember={this.clearPartyMember.bind(this)}\n          />  \n        </main>        \n        <AppFooter/>\n      </div>\n    );\n  }\n}\n\n\n\nexport default withRouter(SiralimPlanner);","import React, {Component} from 'react';\nimport {  BrowserRouter } from \"react-router-dom\";\n\nimport SiralimPlanner from './SiralimPlanner';\n\nclass App extends Component {\n\n  render() {\n    return <BrowserRouter><SiralimPlanner/></BrowserRouter>\n  }\n}\n\n\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}